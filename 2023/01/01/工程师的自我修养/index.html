<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>工程师的自我修养 | Zyumin</title>
  <meta name="keywords" content="">
  <meta name="description" content="工程师的自我修养 | Zyumin">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="为了将事情做好，首先你得喜欢做这件事，而不是喜欢这件事的结果，那仅仅是第二位。">
<meta property="og:type" content="website">
<meta property="og:title" content="tags">
<meta property="og:url" content="http://zyumin.github.io/tags/index.html">
<meta property="og:site_name" content="Zyumin">
<meta property="og:description" content="为了将事情做好，首先你得喜欢做这件事，而不是喜欢这件事的结果，那仅仅是第二位。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-03-23T07:09:38.000Z">
<meta property="article:modified_time" content="2019-03-23T07:09:56.000Z">
<meta property="article:author" content="zhengyumin">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.png">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/github-gist.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 6.2.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.png"/>
</a>
<div class="author">
    <span>zhengyumin</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/Zyumin"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="neteasemusic"
               href="https://music.163.com/#/user/home?id=60037019"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-neteasemusic"></use>
                    </svg>
                
            </a>
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="全部文章">全部文章
            
                <small>(55)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="design">
                        
                        design
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="java">
                        
                        java
                        <small>(9)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="jdk">
                        
                        jdk
                        <small>(13)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="mysql">
                        
                        mysql
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="redis">
                        
                        redis
                        <small>(4)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="spring">
                        
                        spring
                        <small>(12)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  site_url"
               
               href="/about">关于</a>
        
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="55">
<input type="hidden" id="yelog_site_word_count" value="223k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>aop</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>applicationContext</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>beanFactory</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>classLoader</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>collections</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ddd</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>design</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>distributed</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>doc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ejb</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>elasticsearch</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>event</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>file</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>framework</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>gc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>hbase</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>hotspot</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>io</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ioc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>j2ee</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>java</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jdk</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>job</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>juc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jvm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>kafka</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>lang</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>map</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>mysql</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>netty</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>nio</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>note</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>packages</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>patten</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>redis</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>serialization</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>servlet</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>spark</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Spec</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>spring</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>spring-mvc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>spring-webflux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>summary</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>thread</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>tomcat</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>utils</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>zookeeper</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a id="top" class="全部文章 java "
           href="/2019/02/02/Overview_java/"
           data-tag="summary"
           data-author="" >
            <span class="post-title" title="Overview_java">Overview_java</span>
            <span class="post-date" title="2019-02-02 20:43:14">2019/02/02</span>
        </a>
        
        
        <a id="top" class="全部文章 spring "
           href="/2019/03/02/Overview_Spring/"
           data-tag="spring,framework"
           data-author="" >
            <span class="post-title" title="Overview-Spring">Overview-Spring</span>
            <span class="post-date" title="2019-03-02 12:29:06">2019/03/02</span>
        </a>
        
        
        <a id="top" class="全部文章 jdk "
           href="/2019/06/13/Overview_JDK/"
           data-tag="jdk,hotspot"
           data-author="" >
            <span class="post-title" title="Overview_JDK">Overview_JDK</span>
            <span class="post-date" title="2019-06-13 19:36:54">2019/06/13</span>
        </a>
        
        
        <a id="top" class="全部文章 java "
           href="/2020/05/10/%E9%9D%A2%E8%AF%95%E5%B8%B8%E8%A7%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%A2%B3%E7%90%86/"
           data-tag="job"
           data-author="" >
            <span class="post-title" title="面试常见知识点梳理">面试常见知识点梳理</span>
            <span class="post-date" title="2020-05-10 23:46:06">2020/05/10</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2023/01/01/%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="工程师的自我修养">工程师的自我修养</span>
            <span class="post-date" title="2023-01-01 19:52:34">2023/01/01</span>
        </a>
        
        
        <a  class="全部文章 design "
           href="/2022/07/31/%E6%B5%85%E8%B0%88%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1/"
           data-tag="design,patten,ddd"
           data-author="" >
            <span class="post-title" title="浅谈软件设计">浅谈软件设计</span>
            <span class="post-date" title="2022-07-31 00:45:09">2022/07/31</span>
        </a>
        
        
        <a  class="全部文章 java "
           href="/2021/01/13/GC%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93/"
           data-tag="jvm,gc,summary"
           data-author="" >
            <span class="post-title" title="GC调优总结">GC调优总结</span>
            <span class="post-date" title="2021-01-13 21:36:01">2021/01/13</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2020/03/18/Overview-Hbase/"
           data-tag="distributed,hbase,framework"
           data-author="" >
            <span class="post-title" title="Overview_Hbase">Overview_Hbase</span>
            <span class="post-date" title="2020-03-18 22:00:51">2020/03/18</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2020/03/18/Overview-Spark/"
           data-tag="distributed,framework,spark"
           data-author="" >
            <span class="post-title" title="Overview_Spark">Overview_Spark</span>
            <span class="post-date" title="2020-03-18 22:00:43">2020/03/18</span>
        </a>
        
        
        <a  class="全部文章 redis "
           href="/2020/02/28/Redis%E9%9B%86%E7%BE%A4%E7%AF%87/"
           data-tag="framework,redis"
           data-author="" >
            <span class="post-title" title="Redis集群篇">Redis集群篇</span>
            <span class="post-date" title="2020-02-28 18:52:52">2020/02/28</span>
        </a>
        
        
        <a  class="全部文章 redis "
           href="/2020/02/28/Redis%E5%AE%9E%E6%88%98%E7%AF%87/"
           data-tag="framework,redis"
           data-author="" >
            <span class="post-title" title="Redis实战篇">Redis实战篇</span>
            <span class="post-date" title="2020-02-28 18:52:43">2020/02/28</span>
        </a>
        
        
        <a  class="全部文章 redis "
           href="/2020/02/28/Redis%E5%8E%9F%E7%90%86%E7%AF%87/"
           data-tag="framework,redis"
           data-author="" >
            <span class="post-title" title="Redis原理篇">Redis原理篇</span>
            <span class="post-date" title="2020-02-28 18:52:35">2020/02/28</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2020/01/23/spring-aop/"
           data-tag="spring,aop"
           data-author="" >
            <span class="post-title" title="spring-aop">spring-aop</span>
            <span class="post-date" title="2020-01-23 23:54:29">2020/01/23</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2020/01/16/Spring-ApplicationContext/"
           data-tag="spring,applicationContext"
           data-author="" >
            <span class="post-title" title="Spring-ApplicationContext">Spring-ApplicationContext</span>
            <span class="post-date" title="2020-01-16 21:04:45">2020/01/16</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2019/12/05/spring-BeanFactory/"
           data-tag="spring,beanFactory"
           data-author="" >
            <span class="post-title" title="spring-BeanFactory">spring-BeanFactory</span>
            <span class="post-date" title="2019-12-05 21:28:57">2019/12/05</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2019/12/02/spring-Q-A/"
           data-tag="spring"
           data-author="" >
            <span class="post-title" title="spring Q&amp;A">spring Q&amp;A</span>
            <span class="post-date" title="2019-12-02 18:20:38">2019/12/02</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2019/10/29/Documentation-Spring-Core-IOC/"
           data-tag="spring,doc"
           data-author="" >
            <span class="post-title" title="Documentation-Spring_Core_IOC">Documentation-Spring_Core_IOC</span>
            <span class="post-date" title="2019-10-29 21:51:07">2019/10/29</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/09/26/JDK-Packages-java-nio/"
           data-tag="jdk,packages,nio"
           data-author="" >
            <span class="post-title" title="JDK_Packages_java_nio">JDK_Packages_java_nio</span>
            <span class="post-date" title="2019-09-26 10:39:22">2019/09/26</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/09/23/JDK-Packages-java-io/"
           data-tag="jdk,packages,io,serialization,file"
           data-author="" >
            <span class="post-title" title="JDK_Packages_java_io">JDK_Packages_java_io</span>
            <span class="post-date" title="2019-09-23 16:07:43">2019/09/23</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/08/31/JDK-Class/"
           data-tag="jdk"
           data-author="" >
            <span class="post-title" title="JDK_Class">JDK_Class</span>
            <span class="post-date" title="2019-08-31 19:38:34">2019/08/31</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/08/31/JDK-Thread/"
           data-tag="jvm,jdk,hotspot"
           data-author="" >
            <span class="post-title" title="JDK_Thread">JDK_Thread</span>
            <span class="post-date" title="2019-08-31 18:16:08">2019/08/31</span>
        </a>
        
        
        <a  class="全部文章 java "
           href="/2019/08/29/JVM-main%E6%96%B9%E6%B3%95%E5%88%86%E6%9E%90/"
           data-tag="jvm,java"
           data-author="" >
            <span class="post-title" title="JVM_main方法分析">JVM_main方法分析</span>
            <span class="post-date" title="2019-08-29 23:38:13">2019/08/29</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/08/24/JDK-ReentrantLock/"
           data-tag="jdk,juc"
           data-author="" >
            <span class="post-title" title="JDK_ReentrantLock">JDK_ReentrantLock</span>
            <span class="post-date" title="2019-08-24 18:48:54">2019/08/24</span>
        </a>
        
        
        <a  class="全部文章 java "
           href="/2019/08/17/JVM-Synchronized/"
           data-tag="jvm"
           data-author="" >
            <span class="post-title" title="JVM_Synchronized">JVM_Synchronized</span>
            <span class="post-date" title="2019-08-17 17:01:54">2019/08/17</span>
        </a>
        
        
        <a  class="全部文章 java "
           href="/2019/08/11/Overview-Java-Virtual-Machine/"
           data-tag="jvm"
           data-author="" >
            <span class="post-title" title="Overview_Java Virtual Machine">Overview_Java Virtual Machine</span>
            <span class="post-date" title="2019-08-11 19:05:38">2019/08/11</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/08/11/JDK-Packages-java-lang/"
           data-tag="jdk,packages,lang"
           data-author="" >
            <span class="post-title" title="JDK_Packages_java_lang">JDK_Packages_java_lang</span>
            <span class="post-date" title="2019-08-11 19:04:56">2019/08/11</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/08/11/JDK-Packages-java-utils/"
           data-tag="jdk,packages,utils"
           data-author="" >
            <span class="post-title" title="JDK_Packages_java_utils">JDK_Packages_java_utils</span>
            <span class="post-date" title="2019-08-11 19:04:25">2019/08/11</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/08/10/JDK-The-Concurrent-Framework/"
           data-tag="jdk,juc"
           data-author="" >
            <span class="post-title" title="JDK_The Concurrent Framework">JDK_The Concurrent Framework</span>
            <span class="post-date" title="2019-08-10 19:45:39">2019/08/10</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/07/29/JDK-The-Collections-Framework/"
           data-tag="jdk,collections"
           data-author="" >
            <span class="post-title" title="JDK_The Collections Framework">JDK_The Collections Framework</span>
            <span class="post-date" title="2019-07-29 15:26:01">2019/07/29</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/07/10/Note-%E7%A0%81%E5%86%9C%E7%BF%BB%E8%BA%AB/"
           data-tag="java,note"
           data-author="" >
            <span class="post-title" title="Note_码农翻身">Note_码农翻身</span>
            <span class="post-date" title="2019-07-10 22:18:56">2019/07/10</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/07/06/JDK-ClassLoader/"
           data-tag="jdk,classLoader"
           data-author="" >
            <span class="post-title" title="JDK_ClassLoader">JDK_ClassLoader</span>
            <span class="post-date" title="2019-07-06 23:12:51">2019/07/06</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2019/07/03/spring-ApplicationContext%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%92%8C%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6/"
           data-tag="classLoader,spring,servlet,tomcat,event"
           data-author="" >
            <span class="post-title" title="spring-ApplicationContext启动流程和事件机制">spring-ApplicationContext启动流程和事件机制</span>
            <span class="post-date" title="2019-07-03 09:37:08">2019/07/03</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/06/26/Overview_Elasticsearch/"
           data-tag="framework,elasticsearch"
           data-author="" >
            <span class="post-title" title="Overview_Elasticsearch">Overview_Elasticsearch</span>
            <span class="post-date" title="2019-06-26 18:06:48">2019/06/26</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/06/24/J-U-C-ConcurrentHashMap/"
           data-tag="juc,map"
           data-author="" >
            <span class="post-title" title="J.U.C_ConcurrentHashMap">J.U.C_ConcurrentHashMap</span>
            <span class="post-date" title="2019-06-24 19:03:29">2019/06/24</span>
        </a>
        
        
        <a  class="全部文章 java "
           href="/2019/06/19/JVM-Garbage-Collection/"
           data-tag="jvm,gc"
           data-author="" >
            <span class="post-title" title="JVM_Garbage Collection">JVM_Garbage Collection</span>
            <span class="post-date" title="2019-06-19 00:28:10">2019/06/19</span>
        </a>
        
        
        <a  class="全部文章 jdk "
           href="/2019/06/16/J-U-C-InterruptedException/"
           data-tag="juc"
           data-author="" >
            <span class="post-title" title="J.U.C_InterruptedException">J.U.C_InterruptedException</span>
            <span class="post-date" title="2019-06-16 16:09:43">2019/06/16</span>
        </a>
        
        
        <a  class="全部文章 java "
           href="/2019/06/14/Spec-JSR133/"
           data-tag="jvm,Spec,thread"
           data-author="" >
            <span class="post-title" title="Spec_JSR133">Spec_JSR133</span>
            <span class="post-date" title="2019-06-14 19:26:57">2019/06/14</span>
        </a>
        
        
        <a  class="全部文章 java "
           href="/2019/06/13/Spec-Java-Virtual-Machine/"
           data-tag="jvm,Spec"
           data-author="" >
            <span class="post-title" title="Spec_Java Virtual Machine">Spec_Java Virtual Machine</span>
            <span class="post-date" title="2019-06-13 17:25:17">2019/06/13</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/06/12/Overview_Kafka/"
           data-tag="framework,kafka"
           data-author="" >
            <span class="post-title" title="kafka深入浅出">kafka深入浅出</span>
            <span class="post-date" title="2019-06-12 20:05:37">2019/06/12</span>
        </a>
        
        
        <a  class="全部文章 redis "
           href="/2019/06/10/Overview_Redis/"
           data-tag="framework,redis"
           data-author="" >
            <span class="post-title" title="redis深入浅出">redis深入浅出</span>
            <span class="post-date" title="2019-06-10 18:33:40">2019/06/10</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/06/06/Note_java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%9A%84%E8%89%BA%E6%9C%AF/"
           data-tag="juc,java,note"
           data-author="" >
            <span class="post-title" title="Note_java并发编程的艺术">Note_java并发编程的艺术</span>
            <span class="post-date" title="2019-06-06 19:05:01">2019/06/06</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/06/05/Overview_Netty/"
           data-tag="nio,framework,netty"
           data-author="" >
            <span class="post-title" title="Netty深入浅出">Netty深入浅出</span>
            <span class="post-date" title="2019-06-05 22:01:31">2019/06/05</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/06/05/Note_%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3java%E8%99%9A%E6%8B%9F%E6%9C%BA/"
           data-tag="jvm,java,note"
           data-author="" >
            <span class="post-title" title="Note_深入理解java虚拟机">Note_深入理解java虚拟机</span>
            <span class="post-date" title="2019-06-05 21:12:25">2019/06/05</span>
        </a>
        
        
        <a  class="全部文章 mysql "
           href="/2019/06/04/Overview_MySQL/"
           data-tag="mysql"
           data-author="" >
            <span class="post-title" title="MySQL深入浅出">MySQL深入浅出</span>
            <span class="post-date" title="2019-06-04 22:02:31">2019/06/04</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/06/03/Overview_Zookeeper/"
           data-tag="distributed,framework,zookeeper"
           data-author="" >
            <span class="post-title" title="Zookeeper深入浅出">Zookeeper深入浅出</span>
            <span class="post-date" title="2019-06-03 21:15:05">2019/06/03</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/06/03/Overview_Distributed/"
           data-tag="distributed"
           data-author="" >
            <span class="post-title" title="分布式理论基础">分布式理论基础</span>
            <span class="post-date" title="2019-06-03 20:34:37">2019/06/03</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2019/04/10/spring-api-1-0/"
           data-tag="spring"
           data-author="" >
            <span class="post-title" title="spring-api-1.0">spring-api-1.0</span>
            <span class="post-date" title="2019-04-10 09:45:25">2019/04/10</span>
        </a>
        
        
        <a  class="全部文章 mysql "
           href="/2019/03/30/%E8%AE%B0%E4%B8%80%E6%AC%A1mysql%E6%9F%A5%E8%AF%A2in%E7%9A%84%E6%80%9D%E8%80%83/"
           data-tag="mysql"
           data-author="" >
            <span class="post-title" title="记一次mysql查询in的思考">记一次mysql查询in的思考</span>
            <span class="post-date" title="2019-03-30 20:39:49">2019/03/30</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/03/26/%E8%AE%B0%E4%B8%80%E6%AC%A1Broken-pipe%E9%97%AE%E9%A2%98%E7%9A%84%E6%80%9D%E8%80%83/"
           data-tag="tomcat"
           data-author="" >
            <span class="post-title" title="记一次Broken pipe问题的思考">记一次Broken pipe问题的思考</span>
            <span class="post-date" title="2019-03-26 10:53:37">2019/03/26</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2019/03/10/Note_Expert%20One-on-One-J2EE-Development-without-EJB/"
           data-tag="spring,j2ee,ejb"
           data-author="" >
            <span class="post-title" title="Expert One-on-One J2EE Development without EJB">Expert One-on-One J2EE Development without EJB</span>
            <span class="post-date" title="2019-03-10 19:45:57">2019/03/10</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2019/03/10/Note_Expert-One-on-One-J2EE-Design-and-Development/"
           data-tag="spring,j2ee"
           data-author="" >
            <span class="post-title" title="Expert One-on-One J2EE Design and Development">Expert One-on-One J2EE Design and Development</span>
            <span class="post-date" title="2019-03-10 19:45:18">2019/03/10</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2019/03/03/spring-Core-Container%E9%A2%84%E8%A7%88/"
           data-tag="spring,ioc"
           data-author="" >
            <span class="post-title" title="spring-Core-Container预览">spring-Core-Container预览</span>
            <span class="post-date" title="2019-03-03 14:51:56">2019/03/03</span>
        </a>
        
        
        <a  class="全部文章 spring "
           href="/2019/02/03/spring-mvc/"
           data-tag="spring,servlet,spring-mvc,spring-webflux"
           data-author="" >
            <span class="post-title" title="servlet_spring-mvc">servlet_spring-mvc</span>
            <span class="post-date" title="2019-02-03 15:50:16">2019/02/03</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/02/03/Overview_Tomcat/"
           data-tag="servlet,tomcat"
           data-author="" >
            <span class="post-title" title="servlet_tomcat">servlet_tomcat</span>
            <span class="post-date" title="2019-02-03 15:49:08">2019/02/03</span>
        </a>
        
        
        <a  class="全部文章 "
           href="/2019/02/02/Spec_Servlet/"
           data-tag="j2ee,servlet"
           data-author="" >
            <span class="post-title" title="j2ee_servlet">j2ee_servlet</span>
            <span class="post-date" title="2019-02-02 18:05:54">2019/02/02</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-工程师的自我修养" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">工程师的自我修养</h1>
    
    <div class="article-meta">
        
        
        
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2023-01-03 23:48:37'>2023-01-01 19:52</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:8.4k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A5%BD%E4%BB%A3%E7%A0%81%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-text">好代码的定义</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9D%8F%E5%91%B3%E9%81%93%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E6%94%B9%E8%BF%9B"><span class="toc-text">坏味道以及如何改进</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E5%90%8D%E3%80%81%E6%B3%A8%E9%87%8A%E4%B8%8D%E7%AE%80%E5%8D%95"><span class="toc-text">命名、注释不简单</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E5%90%8D"><span class="toc-text">命名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A"><span class="toc-text">注释</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84"><span class="toc-text">结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97if"><span class="toc-text">嵌套if</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E7%A9%B7%E5%B0%BDelse"><span class="toc-text">可穷尽else</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%8C%E5%8F%8D%E9%80%BB%E8%BE%91"><span class="toc-text">复杂表达式，反逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%BC%82%E5%B8%B8%E6%9B%BF%E4%BB%A3%E8%BF%94%E5%9B%9E%E9%94%99%E8%AF%AF%E7%A0%81"><span class="toc-text">使用异常替代返回错误码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%B1%82%E7%BA%A7"><span class="toc-text">调用层级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%A4%8D"><span class="toc-text">重复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB"><span class="toc-text">类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B%E5%88%86%E7%A6%BB"><span class="toc-text">处理流程分离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E5%B1%82%E7%BA%A7%E5%88%86%E7%A6%BB"><span class="toc-text">抽象层级分离</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7%E3%80%81%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="toc-text">使用语言特性、第三方库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7"><span class="toc-text">语言特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Optional"><span class="toc-text">Optional</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="toc-text">函数式编程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E5%B8%B8%E8%A7%81%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">函数式编程常见的问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93"><span class="toc-text">第三方库</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-4 i,
    .toc-level-4 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>​	新年伊始，回顾之前看了一些文章和课程，有关于代码编程风格，一直都想做个简单的总结。同时结合工作以来中code review，一些常见问题进行分析，补充。聊聊作为一名工程师，如何写出稍微不那么难看的代码的一些方法和看法，欢迎小伙伴们一起讨论补充。</p>
<p>​	目录如下</p>
<ul>
<li>好代码的定义</li>
<li>坏味道以及如何改进</li>
<li>总结</li>
</ul>
<h1 id="好代码的定义"><a href="#好代码的定义" class="headerlink" title="好代码的定义"></a>好代码的定义</h1><p>​	关于好代码的定义，各路大神都给出了自己的定义和见解</p>
<ul>
<li>整洁的代码如同优美的散文。—— Grady Booch</li>
<li>任何一个傻瓜都能写出计算机可以理解的代码。唯有写出人类容易理解的代码，才是优秀的程序员。—— Martin Fowler</li>
</ul>
<p>	</p>
<p>​	相信大家都有看过好的代码，这些代码可能有如下优点，优雅，简单，工整，整洁。这里可能有些小伙伴会想，代码写的好看和不好看有什么用，还不是一样的运行。那么我们为什么要写好代码呢？主要有以下两个</p>
<p><strong>面向开发者，便于后续维护</strong></p>
<p>​	是的，代码写出来第一是运行，但是其实在软件的生命周期中，运维的占比并不低。更多的时候是给人读的，可能是后续的维护人员，更多时候是一段时间后的作者本人。（所以不要给自己埋坑）。</p>
<p><strong>面向机器，能够高效运行</strong></p>
<p>​	另外能运行和 能否正确运行以及高效运行也是也要求我们写出不那么差的代码。性能怎么样，怎么写出有利于cpu、内存 、IO。</p>
<p>以怎么写出缓存友好的代码为例，如下面的两种遍历数组方式，可能性能会存在差异。</p>
<pre><code class="c">//case 1
for(i = 0; i &lt; N; i+=1) &#123;
  for(j = 0; j &lt; N; j+=1) &#123;
        array[i][j] = 0;
  &#125;
&#125;
//case 2
for(i = 0; i &lt; N; i+=1) &#123;
  for(j = 0; j &lt; N; j+=1) &#123;
        array[j][i] = 0;
  &#125;
&#125;
</code></pre>
<p>​	怎么写好代码？低耦合高内聚，单一职责，简单，这些回答可能都太抽象了，那么如果说什么样的代码是不好的，可能会简单些。</p>
<h1 id="坏味道以及如何改进"><a href="#坏味道以及如何改进" class="headerlink" title="坏味道以及如何改进"></a>坏味道以及如何改进</h1><p>​	下面我们来讨论下，什么情况会导致我们写出具有坏味道的代码。主要从命名、结构，类、函数几个方面展开。</p>
<h2 id="命名、注释不简单"><a href="#命名、注释不简单" class="headerlink" title="命名、注释不简单"></a>命名、注释不简单</h2><h3 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h3><p>​	这里的命名指的是 类、方法、变量的命名，常用的命名规则类名、变量名是一个名词，表示一个对象，而方法名则是一个动词，或者是动宾短语，表示一个动作。一个命名最好能表达尽可能多的业务含义，例如作为变量，不需要看上下文就能知道作用。如果更严格的要求自己的话，就是能够自解释，不需要通过注释的来额外补充。举个例子，随便打开一个项目全局搜下代码关键字list,map,可能会发现一堆。挑一个来看下</p>
<pre><code class="java">public List&lt;ValidateRecord&gt; getList(String id)&#123;
  List&lt;Record&gt; list = recordDao.queryList(id);
  
  List&lt;ValidateRecord&gt; list1 = Lists.newArrayList();
  for(Record record:list)&#123;
    if(record.getStatus().equals(&quot;1&quot;))&#123;
      //模拟业务逻辑
      list1.add(doSomething(record));
    &#125;
  &#125;
  return list1;
&#125;
</code></pre>
<p>​	上面我们假设整体逻辑没问题，能够正常运行，但是当作为一个阅读者去看这段代码的时候，可能会有如下几个疑问点</p>
<ul>
<li>id是什么，我们需要点击下该方法查询下该方法的调用处入口，是什么id，staffId还是record相关的id</li>
<li>是list是什么意思，代表了什么，我们需要点击queryList方法去查看具体获取了什么</li>
<li>list1又是什么，返回去怎么使用getList</li>
<li>record.getStatus()&#x3D;&#x3D;’1’，1是代表什么意思</li>
</ul>
<p>​	这里的问题是命名过于宽泛，不能精准描述，这是很多代码在命名上存在的严重问题，也是代码难以理解的根源所在。我们可以给泛化的名字附上业务含义， 来看看我们优化后的展示。</p>
<pre><code class="java">public List&lt;ValidateRecord&gt; getValidateRecordList(String staffId)&#123;
  List&lt;Record&gt; staffRecordList = recordDao.queryAllStaffRecordList(staffId);
  
  List&lt;ValidateRecord&gt; validateRecordList = Lists.newArrayList();
  for(Record record:staffRecordList)&#123;
    if(record.isValidated())&#123;
      //模拟业务逻辑
      validateRecordList.add(toValidateRecord(record));
    &#125;
  &#125;
  return validateRecordList;
&#125;
</code></pre>
<p>​	经过我们简单的改造后的代码是不是已经比较顺眼了，我们可以大致看出，这段代码的逻辑是通过员工id获取Record列表，再过滤出需要处理的有效Record进行处理转换。当然这里还有优化空间（命名上例如list，在实际的代码中，技术名词的出现，往往就代表着它缺少了一个应有的模型），我们下面再展开。命名的选择也不是不变的，一旦发现有更好的，可以持续优化。在开发中要警惕以下泛用的词语（data、info、flag、process、handle、build、maintain、manage、modify）</p>
<p>​	除了泛化，用技术命名，同时还存在另一种情况就是，在一些命名上可能会出现两个词都可以表达意思，会导致代码中不一致的，产生混乱。譬如mobile和phone, 都可以用来表示手机，这就需要团队在共同维护一份语言。也就是DDD中提到的统一语言（DDL），统一词汇表。</p>
<p>​	简单总结下关于命名的要求，好的命名要体现出这段代码在做的事情，而无需展开代码了解其中的细节，这是最低的要求。再进一步，好的命名要准确地体现意图，而不是实现细节。更高的要求是，用业务语言写代码。</p>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>​	关于注释文档这个，这里也提一下，不是说注释不重要或者多余，而是要根据情况讨论。我认为以下情况是必须要有文档注释补充的。</p>
<ul>
<li>接口协议字段含义，http接口，服务接口协议</li>
<li>程序中复杂逻辑、流程</li>
<li>技术债或者业务的特殊逻辑，防止后人踩坑，给予提醒。（当然如果有坑尽快解决）</li>
<li>…</li>
</ul>
<p>​	当然javadoc中有许多有用的语法,注解我们也可以使用，常见的有</p>
<ul>
<li>某个类已经过期或者准备废弃可以使用@Deprecated标注，告诉其他小伙伴不要使用，当然同时如果能在注释中标识出why,when就更好了（@deprecated,@since  ）,同时如果有替代的方法或者类也可以标注下（使用@see）。</li>
<li>我们为某个类的字段type定义了枚举，我们也可以使用@see来标识下。</li>
<li>在idea中会自动帮我们生成入参（@param）和出参(@Return)都有对应的,同时如果有抛出的异常（@throws）也需要标识下，怎么触发，怎么处理。</li>
<li>以及如果有时候项目进度比较紧，某些功能、问题暂时挂起，或者有优化空间可以使用TODO,FIXME标注下</li>
<li>….</li>
</ul>
<p>​	同时注释和文档如果有变更，也需要同步更改，最差的情况是注释和代码逻辑不一致。第二坏的情况是不写注释。第三是注释比较啰嗦，有和没有等于没说。所以可以看出简单的命名和注释，如果想写好也不简单。这里的最佳实践是，先竭力把代码写到不需要用注释，而把注释当作最后的选择。</p>
<h2 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h2><p> 下面我们从结构方面来看看，先来看一张图</p>
<p><img src="/../../../../second-brain/%E7%AC%AC%E4%BA%8C%E5%A4%A7%E8%84%91/%E9%99%84%E4%BB%B6/%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/207d60ffb815dff3272090f876503a4f.jpeg" alt="img"></p>
<h3 id="嵌套if"><a href="#嵌套if" class="headerlink" title="嵌套if"></a>嵌套if</h3><p>​	嵌套的代码，可能看到上述的图，我们都会觉得印象深刻，但其实在代码工程中，虽然没有那么夸张，但到处有它的影子，例如我们来看下面这段代码</p>
<pre><code class="java">public void visitTreeNode() &#123;
  ConfigTreeNode treeNode = this.queryConfigTreeNode();
  if (treeNode != null &amp;&amp; !CollectionUtils.isEmpty(tree.getChildrenNodes())) &#123;
    List&lt;ConfigTreeNode&gt; childrenNodes = treeNode.getChildrenNodes();
    for (ConfigTreeNode subNode : childrenNodes) &#123;
      if (subNode.isValid()) &#123;
        //do sth
        visit(subNode);
      &#125;
    &#125;
  &#125;
&#125;
</code></pre>
<p>​	这段代码的大概意思是遍历树节点，对节点的子节点进行遍历。很常见的代码，代码逻辑并不复杂，上述代码只是短短的两层if一层for,</p>
<p>但如果逻辑在复杂一点，例如visit方法是平铺展开的，里面又嵌套了if，是不是会感觉到阅读会是种很大的负担。这在一些代码检测中是会给出提示的，圈复杂度（Cyclomatic complexity，简称 CC）。这里我们可以用一种方式来优化这种嵌套的层级，以卫语句取代嵌套的条件表达式（Replace Nested Conditional with Guard Clauses）。</p>
<p>​	改进后的代码如下</p>
<pre><code class="java">public void visitTreeNode() &#123;
  ConfigTreeNode treeNode = this.queryConfigTreeNode();
  if (treeNode == null || CollectionUtils.isEmpty(tree.getChildrenNodes())) &#123;
          return;
  &#125;
  List&lt;ConfigTreeNode&gt; childrenNodes = treeNode.getChildrenNodes();
  for (ConfigTreeNode subNode : childrenNodes) &#123;
    visit(subNode);
  &#125;
&#125;
public void visit(ConfigTreeNode treeNode)&#123;
  if(!treeNode.isValid())&#123;
    return ;
  &#125;
  //do sth
&#125;
</code></pre>
<p>​	这里的缩减层级就只有一层，其中if (subNode.isValid()) 的判断我们放在函数visit中去处理。当代码里只有一层缩进时，代码的复杂度就大大降低了，理解成本和出现问题之后定位的成本也随之大幅度降低。</p>
<h3 id="可穷尽else"><a href="#可穷尽else" class="headerlink" title="可穷尽else"></a>可穷尽else</h3><p>​	如果我说尽量不要使用else，是不是会打破你的认知，大多数人印象中，if 和 else都是成对出现的，那么else可以不写吗，为什么？一起来看下下面这段代码（主要为了演示if else，其他细节忽略）</p>
<pre><code class="java">public void queryProductInfoByType(CutsomerEnterpriseProduct product)&#123;
        ProductInfo productInfo;
        if(ProductTypeEnums.WYD.getCode().equals(product.getType())&#123;
            productInfo = queryWYD(product);
        &#125;else if(ProductTypeEnums.GHD.getCode().equals(product.getType())&#123;
            productInfo = queryGHD(product);
        &#125;else if(ProductTypeEnums.DHD.getCode().equals(product.getType())&#123;
            productInfo = queryDHD(product);
        &#125;else if(ProductTypeEnums.KCD.getCode().equals(product.getType())&#123;
            productInfo = queryKCD(product);
        &#125;else&#123;
            productInfo = queryOTHER(product);
        &#125;
&#125;
</code></pre>
<p>​	这段代码大致逻辑就是入参数的产品类型根据类型，应该也算挺常见的一段代码，但这里的问题是分支过多，每个分支都是一种分支，因为一段代码的分支过多，其复杂度就会大幅度增加，当我们需要修改的时候，需要新增一种类型的时候，我们需要小心翼翼的检查每个分支的条件，直到最后的else(这里可能只是简单的类型判断，如果逻辑稍微复杂的呢，可想象一些数值计算)。所以，就这段代码而言，如果想不使用 else，一个简单的处理手法就是让每个逻辑提前返回</p>
<pre><code class="java">public void queryProductInfoByType(CutsomerEnterpriseProduct product)&#123;
        if(ProductTypeEnums.WYD.getCode().equals(product.getType())&#123;
            return queryWYD(product);
        &#125; 
    if(ProductTypeEnums.GHD.getCode().equals(product.getType())&#123;
            return queryGHD(product);
        &#125;
    if(ProductTypeEnums.DHD.getCode().equals(product.getType())&#123;
            return queryDHD(product);
        &#125;
    if(ProductTypeEnums.KCD.getCode().equals(product.getType())&#123;
            return queryKCD(product);
        &#125;
    //case 1
    return queryOTHER(product);
        
    //case 2
    //if(ProductTypeEnums.OTHER.getCode().equals(product.getType())&#123;
    //  return queryOTHER(product);
    //&#125;
    //throw new BizException(RspCodeEnums.ERROR,&quot;unkonw productType&quot;);
&#125;
</code></pre>
<p>​	可以看到我们同样使用了return的方式代替了else的分支，再来说下else的另一个坏味道，因为else它隐藏着一种不确定性，else，一般会留给别人一个疑惑。例如会有上述代码中末尾中的case1 和case2两种情况，在代码不变的情况下，功能是相同的。</p>
<p>​	但当新增一种类型需要处理的时候，这里的逻辑就会有不一致的情况了。case1的情况如果不改动，处理逻辑就是当成其他处理。而case2会去检验，提前暴露错误。所以如果分支判断中，如果能够穷尽类型，就请穷尽，慎用else，避免存在二义性。</p>
<p>​	当然对于这种逻辑上还比较简单的代码，这么改造还是比较容易的，而对于一些更为复杂的代码，也许就要用到多态来改进代码了（可以将分支中的操作封装到不同的处理器中，根据类型路由到对应处理器处理，做到符合开闭原则。这里涉及到设计模式的就不展开了）</p>
<h3 id="复杂表达式，反逻辑"><a href="#复杂表达式，反逻辑" class="headerlink" title="复杂表达式，反逻辑"></a>复杂表达式，反逻辑</h3><p>​	再来看看if 常见的踩坑问题还有哪些，例如产品人员和你沟通，想统计员工的工作时长的数据，这样描述9点之前和18点之后的不算，如果平铺直述，直接转译为代码，那么我们可能会写出这样的代码。</p>
<pre><code class="java">public void countStaffWorkTime(StaffWorkTime staffWorkTime)&#123;
            if(!(staffWorkTime.getLoginTime()&lt;9||staffWorkTime.getLoginTime()&gt;18))&#123;
            doSth(staffWorkTime);
      &#125;
&#125;
</code></pre>
<p>​	这里的逻辑判断中用了用了或逻辑和反逻辑，这里的业务逻辑还比较简单，但如果反逻辑里面很复杂，比如再加多几个条件，这一下我们的心智负担就会很大，逐个条件看完，最后还得取反逻辑。那为什么不简单优化下</p>
<pre><code class="java">public void countStaffWorkTime(StaffWorkTime staffWorkTime)&#123;
            if(staffWorkTime.getLoginTime()&gt;=9 &amp;&amp; staffWorkTime.getLoginTime()&lt;=18)&#123;
            doSth(staffWorkTime);
      &#125;
&#125;
</code></pre>
<p>​	另一个是，条件表达式如果是复杂的，上述只有两个判断，如果有多个的情况呢？如果需求在原来基础上再加个中午12点到2点也不算。那么我们的代码就会变更为</p>
<pre><code class="java">public void countStaffWorkTime(StaffWorkTime staffWorkTime)&#123;
            if((staffWorkTime.getLoginTime()&gt;=9 &amp;&amp; staffWorkTime.getLoginTime()&lt;=12)||(staffWorkTime.getLoginTime()&gt;=14 &amp;&amp; staffWorkTime.getLoginTime()&lt;=18))&#123;
            doSth(staffWorkTime);
      &#125;
&#125;
</code></pre>
<p>​	是不是开始复杂起来了，这时候就需要将这个表达式提取出来，我们可以这样优化下。</p>
<pre><code class="java">public void countStaffWorkTime(StaffWorkTime staffWorkTime)&#123;
          boolean ifStaffWorkTime = checkIfStaffWorkTime(staffWorkTime);
            if(ifStaffWorkTime)&#123;
            doSth(staffWorkTime);
      &#125;
&#125;
public boolean checkIfStaffWorkTime(StaffWorkTime staffWorkTime)&#123;
      boolean ifStaffWorkTime = (staffWorkTime.getLoginTime()&gt;=9 &amp;&amp; staffWorkTime.getLoginTime()&lt;=12)||(staffWorkTime.getLoginTime()&gt;=14 &amp;&amp; staffWorkTime.getLoginTime()&lt;=18);
  return ifStaffWorkTime;
&#125;
</code></pre>
<h3 id="使用异常替代返回错误码"><a href="#使用异常替代返回错误码" class="headerlink" title="使用异常替代返回错误码"></a>使用异常替代返回错误码</h3><p>最后我们再来看下，同样关于if，else</p>
<pre><code class="java">public int deletePageObject()&#123;
  if(deletePage() == OK)&#123;
      if(registry.deleteReference(page.getName()) == OK)&#123;
          if(configKeys.deleteKey(page.getName().getMakeKey()) == OK)&#123;
              logger.log(&quot;page deleted&quot;);
              return OK;
          &#125;else&#123;
              logger.log(&quot;configKey not deleted&quot;);
              return Errors.ConfigKey;
          &#125;
      &#125;else&#123;
          logger.log(&quot;deleteReference from registry failed&quot;)
            return Errors.Reference;
      &#125;
  &#125;else&#123;
      logger.log(&quot;delete failed&quot;)
      return Errors.Page;
  &#125;
&#125;
</code></pre>
<p>​	上述代码的大概意思,在方法中删除page，reference ，和key，并将结果返回。</p>
<p>​	针对错误码的判断会导致更深层次的嵌套结构，返回错误码就意味着要求调用者跟着处理错误，一般我们还需要将try&#x2F;Catch代码块给抽离出去，另外形成方法。防止代码块过多搞乱代码结构，分不清错误处理还是正常流程。同时因为方法只做一件事，错误处理就是一件事，因此错误处理的方法不应该在做其他事，也就是如果一个方法中有try关键字，那try就是方法的开头。catch&#x2F;finally代码块后面也不应该再有内容。</p>
<pre><code class="java">try&#123;
    deletePage(page);
    registry.deleteReference(page.getName());
    configKeys.deleteKey(page.getName().getMakeKey());
&#125;catch(Exception e)&#123;
    logger.log(e.getMessage());
&#125;
</code></pre>
<p>​	通过抛出异常的方式，将正常流程和异常流程分离开来。</p>
<h3 id="调用层级"><a href="#调用层级" class="headerlink" title="调用层级"></a>调用层级</h3><p>​	依赖关系的混乱，传统MVC的三层结构在面对复杂项目时候，本来就会出现调用混乱的关系，再加上如果不遵守，直接跨层级调用，会将更加放大这个问题，例如controller层直接调用Dao层，或是A-Servier,调用B-Dao。</p>
<h3 id="重复"><a href="#重复" class="headerlink" title="重复"></a>重复</h3><p>​	关于重复代码，这里简单补充下，我们可能很简单可以分辨出重复的代码，这些代码的产生通常都是复制粘贴，我们应对这种情况的</p>
<p>通常的做法是，先提取出函数，然后，在需要的地方调用这个函数。其实，复制粘贴的重复代码是相对容易发现的，但有一些代码是有类</p>
<p>似的结构，这也是重复代码，但可能日常开发中会对这类坏味道忽略。例如看下面代码实例</p>
<pre><code class="java">@Task
public void sendBook() &#123;
  try &#123;
    this.service.sendBook();
  &#125; catch (Throwable t) &#123;
    this.notification.send(new SendFailure(t)));
    throw t;
  &#125;
&#125;

@Task
public void sendChapter() &#123;
  try &#123;
    this.service.sendChapter();
  &#125; catch (Throwable t) &#123;
    this.notification.send(new SendFailure(t)));
    throw t;
  &#125;
&#125;

@Task
public void startTranslation() &#123;
  try &#123;
    this.service.startTranslation();
  &#125; catch (Throwable t) &#123;
    this.notification.send(new SendFailure(t)));
    throw t;
  &#125;
&#125;
</code></pre>
<p>​	这三段函数业务的背景是：一个系统要把作品的相关信息发送给翻译引擎。所以，结合着代码，我们就不难理解它们的含义，sendBook 是把作品信息发出去，sendChapter 就是把章节发送出去，而 startTranslation 则是启动翻译。</p>
<p>这三个函数可能在许多人看来已经写得很简洁了，但是，这段代码的<strong>结构上</strong>却是有重复的，请把注意力放到 catch 语句里。</p>
<p>​	我们可以看到，虽然这三个函数调用的业务代码不同，但它们的结构是一致的，其基本流程可以理解为：</p>
<ul>
<li>调用业务函数；</li>
<li>如果出错，发通知。</li>
</ul>
<p>​	我们可以优化为</p>
<pre><code class="java">private void executeTask(final Runnable runnable) &#123;
  try &#123;
    runnable.run();
  &#125; catch (Throwable t) &#123;
    this.notification.send(new SendFailure(t)));
    throw t;
  &#125;
&#125;

@Task
public void sendBook() &#123;
  executeTask(this.service::sendBook);
&#125;

@Task
public void sendChapter() &#123;
  executeTask(this.service::sendChapter);
&#125;

@Task
public void startTranslation() &#123;
  executeTask(this.service::startTranslation);
&#125;
</code></pre>
<p>​	这样的好处是如果需要一些通用结构的调整，如运行前日志，异常处理变更，都可以只在executeTask中修改，把变化控制在一个地方。这个例子并不复杂，关键点在于，能不能发现结构上的重复。因为相比于直接复制的代码，结构上的重复看上去会有一些迷惑性。</p>
<h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><p>​	判断一个类的职责是否单一，有简单的几个方法</p>
<ul>
<li>多人协作开发时候，经常冲突的类</li>
<li>使用构造函数的注入方式，当你的构造函数的列表很长的时候，你就会去思考，该类的职责是否太重了，是否需要将其中依赖的服务进行合并封装。	</li>
<li>这个类的行数</li>
</ul>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>​	函数是我们代码中除了变量外最常见的家伙，那么和函数打交道有什么需要注意的地方吗，先来看下面这段代码（太长可以直接跳过）</p>
<pre><code class="java">
public void executeTask() &#123;
    ObjectMapper mapper = new ObjectMapper();
    CloseableHttpClient client = HttpClients.createDefault();
    List&lt;Chapter&gt; chapters = this.chapterService.getUntranslatedChapters();
    for (Chapter chapter : chapters) &#123;
        // Send Chapter
        SendChapterRequest sendChapterRequest = new SendChapterRequest();
        sendChapterRequest.setTitle(chapter.getTitle());
        sendChapterRequest.setContent(chapter.getContent());

        HttpPost sendChapterPost = new HttpPost(sendChapterUrl);
        CloseableHttpResponse sendChapterHttpResponse = null;
        String chapterId = null;
        try &#123;
            String sendChapterRequestText = mapper.writeValueAsString(sendChapterRequest);
            sendChapterPost.setEntity(new StringEntity(sendChapterRequestText));
            sendChapterHttpResponse = client.execute(sendChapterPost);
            HttpEntity sendChapterEntity = sendChapterPost.getEntity();
            SendChapterResponse sendChapterResponse = mapper.readValue(sendChapterEntity.getContent(), SendChapterResponse.class);
            chapterId = sendChapterResponse.getChapterId();
        &#125; catch (IOException e) &#123;
            throw new RuntimeException(e);
        &#125; finally &#123;
            try &#123;
                if (sendChapterHttpResponse != null) &#123;
                    sendChapterHttpResponse.close();
                &#125;
            &#125; catch (IOException e) &#123;
                // ignore
            &#125;
        &#125;


        // Translate Chapter
        HttpPost translateChapterPost = new HttpPost(translateChapterUrl);
        CloseableHttpResponse translateChapterHttpResponse = null;
        try &#123;
            TranslateChapterRequest translateChapterRequest = new TranslateChapterRequest();
            translateChapterRequest.setChapterId(chapterId);
            String translateChapterRequestText = mapper.writeValueAsString(translateChapterRequest);
            translateChapterPost.setEntity(new StringEntity(translateChapterRequestText));
            translateChapterHttpResponse = client.execute(translateChapterPost);
            HttpEntity translateChapterEntity = translateChapterHttpResponse.getEntity();
            TranslateChapterResponse translateChapterResponse = mapper.readValue(translateChapterEntity.getContent(), TranslateChapterResponse.class);
            if (!translateChapterResponse.isSuccess()) &#123;
                logger.warn(&quot;Fail to start translate: &#123;&#125;&quot;, chapterId);
            &#125;
        &#125; catch (IOException e) &#123;
            throw new RuntimeException(e);
        &#125; finally &#123;
            if (translateChapterHttpResponse != null) &#123;
                try &#123;
                    translateChapterHttpResponse.close();
                &#125; catch (IOException e) &#123;
                    // ignore
                &#125;
            &#125;
        &#125;
    &#125;
</code></pre>
<p>​	这段代码的逻辑是 1.把没有翻译过的章节发到翻译引擎，2.启动翻译过程。在这里翻译引擎是另外一个服务，需要通过 HTTP 的形式向它发送请求。</p>
<p>​	这里它的变量命名，结构都没什么问题，那么是不是就没什么问题了呢，其实不然，它也是有坏味道的。</p>
<p>​	那么它存在什么问题呢？第一印象是不是有觉得这个函数太长了，对，这个就是坏味道的一种，长函数。 它遍布在我们的代码中，不知道大家在实际工作中遇到最长的函数有多长，几百上千行的函数应该是有看过的吧。</p>
<p>​	那长函数会有什么问题呢？我觉得最大的危害是加大了后续维护的人的工作量，无论是去被迫理解一个长函数的含义，还是要在一个长函数中，小心翼翼地找出需要的逻辑，按照需求微调一下，都需要完整的读完整个函数，陷入不同的细节之中。那么如果我们要解决长函数这个问题，首先要知道它是怎么产生的。</p>
<p>主要有如下原因</p>
<ul>
<li>平铺直述：把多个业务处理流程放在一个函数里实现；把不同层面的细节放到一个函数里实现。</li>
<li>需求迭代：一次加一点。</li>
</ul>
<p>既然这里是因为把不同细节，层级都揉在一起，那么我们只要分离开就可以了，下面我们来看下是怎么解决</p>
<h3 id="处理流程分离"><a href="#处理流程分离" class="headerlink" title="处理流程分离"></a><strong>处理流程分离</strong></h3><p>​	首先是不同业务处理流程的分离，这里发送章节和启动翻译是两个过程，显然，这是可以放到两个不同的函数中去实现的，不同函数只处理一个事情（单一职责无处不在)，所以，我们只要做一下提取函数，就可以把这个看似庞大的函数拆开，而拆出来的几个函数规模都会小很多，像下面这样：</p>
<pre><code class="java">public void executeTask() &#123; 
      ObjectMapper mapper = new ObjectMapper(); 
      CloseableHttpClient client = HttpClients.createDefault(); 
      List chapters = this.chapterService.getUntranslatedChapters(); 
      for (Chapter chapter : chapters) &#123; 
          String chapterId = sendChapter(mapper, client, chapter); 
          translateChapter(mapper, client, chapterId); 
    &#125;
&#125;
</code></pre>
<p>​	这样优化后是不是就很清晰了，如果维护者需要修改的是发送章节部分的内容。再来看下不同细节的分离。</p>
<h3 id="抽象层级分离"><a href="#抽象层级分离" class="headerlink" title="抽象层级分离"></a>抽象层级分离</h3><p>我们以sendChapter为例子来看看做了什么优化</p>
<pre><code class="java">private String sendChapter(final ObjectMapper mapper,
                           final CloseableHttpClient client,
                           final Chapter chapter) &#123;
    SendChapterRequest request = asSendChapterRequest(chapter);

    CloseableHttpResponse response = null;
    String chapterId = null;
    try &#123;
        HttpPost post = sendChapterRequest(mapper, request);
        response = client.execute(post);
        chapterId = asChapterId(mapper, post);
    &#125; catch (IOException e) &#123;
        throw new RuntimeException(e);
    &#125; finally &#123;
        try &#123;
            if (response != null) &#123;
                response.close();
            &#125;
        &#125; catch (IOException e) &#123;
            // ignore
        &#125;
    &#125;
    return chapterId;
&#125;

private SendChapterRequest asSendChapterRequest(final Chapter chapter) &#123;
    SendChapterRequest request = new SendChapterRequest();
    request.setTitle(chapter.getTitle());
    request.setContent(chapter.getContent());
    return request
&#125;
</code></pre>
<p>​	我们以 asSendChapterRequest 这个方法来说，我们可以很清楚的看到，SendChapterRequest的构建在函数中和发送相关的逻辑完全就是不同层级的，一个是构建的细节，一个是发送的动作。我们完全可以把构建请求的细节封装，抽取出来，不对外暴露相关细节，维护者在阅读代码的时候不会一头扎进细节，而是层层递进，就会清晰很多。这便是单一抽象层次原则（SLAP）。</p>
<p>​	关于抽象层次这个再举个简单的例子说明下，比如有这样一个问题，把一头大象放进冰箱需要几步</p>
<pre><code class="java">//把大象装进冰箱
public void frozenElephant()&#123;
  //1.捕获大象
  //2.运输大象
  //3.打开冰箱
  //4.放入大象
  //5.关闭冰箱
&#125;
</code></pre>
<p>​	我们可能会写出这样的代码，那么存在什么问题呢？显然这里的 步骤1、 2 的层级和3、4 、5的层级抽象层次是不一致的。步骤3、4 、5在这里暴露的细节，都是把大象放进冰箱的操作步骤，属于低层次的抽象。所以这里应该把3、4 、5合并聚合成一个步骤，统一层级，重构后的代码如下：</p>
<pre><code class="java">public void frozenElephant()&#123;
    //1. 捕捉大象
    catchElephant();
    //2. 运输大象
    transportElephant();
    //3. 将大象放入冰箱
    putElephantInRefrigerator();
&#125;
public void putElephantInRefrigerator()&#123;
    //打开冰箱
    //放入大象
    //关闭冰箱
&#125;
</code></pre>
<h2 id="使用语言特性、第三方库"><a href="#使用语言特性、第三方库" class="headerlink" title="使用语言特性、第三方库"></a>使用语言特性、第三方库</h2><p>​	因为语言本身的演化，每个阶段的正确写法（或者说更好的写法）是不一样的，就以JDK为例，举几个改变较大的特征</p>
<ul>
<li>在Java5版本，forEach语句改变了我们写遍历集合的方式，不用再通过下标的方式去获取对象，没有了越界的烦恼</li>
<li>在Java7版本，新增AutoCloseable接口，不用再写重复复杂臃肿的try catch finally对资源的关闭</li>
<li>在Java8版本，支持了lambda表达式，函数式编程支持，Optional对空指针的处理</li>
<li>在Java9版本，参考Google Guava的优秀实现对集合类进行增强</li>
<li>在Java10版本，类似JS可以通过var来修饰局部变量</li>
<li>在Java11版本，Http Client重写，支持HTTP&#x2F;1.1和HTTP&#x2F;2 ，也支持 websockets，对Stream、Optional、集合API进行增强</li>
<li>…</li>
<li>再到Java17版本，虽然JDK17也是一个LTS版本，但是并没有像JDK8和JDK11一样引入比较突出的特性，主要是对前几个版本的整合和完善。</li>
</ul>
<p>​	这里还是通过一段代码开头，来看看具体</p>
<pre><code class="java">List&lt;Permission&gt; permissions = new ArrayList&lt;&gt;();
permissions.add(Permission.BOOK_READ);
permissions.add(Permission.BOOK_WRITE);
//do sth use permissions

private static Map&lt;Locale, String&gt; codeMapping = new HashMap&lt;&gt;();
codeMapping.put(LOCALE.ENGLISH, &quot;EN&quot;);
codeMapping.put(LOCALE.CHINESE, &quot;CH&quot;);
//do sth use codeMapping
</code></pre>
<p>​	这种代码是非常常见的，声明一个集合，然后，调用一堆添加的方法，将所需的对象添加进去。但这里声明和初始化是割裂开来的，并不是一个完整的对象，所以有更好的写法，在Java9中</p>
<pre><code class="java">List&lt;Permission&gt; permissions = List.of(
  Permission.BOOK_READ, 
  Permission.BOOK_WRITE
);
//do sth use permissions
</code></pre>
<p>​	如果用的Java 9 之后的版本，使用 Guava（Google 提供的一个 Java 库）也是可以做成类似的效果：</p>
<pre><code class="java">List&lt;Permission&gt; permissions = ImmutableList.of(
  Permission.BOOK_READ, 
  Permission.BOOK_WRITE
);
</code></pre>
<h3 id="语言特性"><a href="#语言特性" class="headerlink" title="语言特性"></a>语言特性</h3><p>​	鉴于我们现在大多数在用的java8的版本，主要来说下java8中的一些优化，主要是对Optional，函数式编程两个进行讨论</p>
<h4 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a>Optional</h4><p>​	首先来看看出问题最多的，NullPointerException，它经常出现在各种报错的上下文中，而为了避免这种错误我们会写出这样的代码</p>
<p>假设有这样一个例子</p>
<pre><code class="java">String name = book.getAuthor().getName();
</code></pre>
<p>这种链式调用，我们都要当心，因为其中getAuthor如果为null，那就会导致空指针异常了。所以更严谨的写法应该是这样</p>
<pre><code class="java">Author author = book.getAuthor();
String name = (author == null) ? null : author.getName();
</code></pre>
<p>但是这种严格校验的写法，很大程度依赖开发者的自觉，以及是否有意识到，需要小心翼翼的查看是否有可能返回null值。对于这个如此常见的问题，Java 8 中已经给出了一个解决方案，它就是 Optional</p>
<p>Optional 提供了一个对象容器，你需要从中“取出（get）”你所需要的对象，但在取出之前，你需要判断一下这个对象容器中是否真的存在一个对象,我们用Optional来优化上述代码，应该是这样的</p>
<pre><code class="java">Optional author = book.getAuthor();
String name = author.map(Author::getName).orElse(null);
</code></pre>
<p>​	这种做法和之前做法的最大差别在于，你不会忘掉判断对象是否存在的过程，因为你需要从 Optional 这个对象容器中取出存在里面的对象。这里Optional提醒了后续使用的人，这里有可能返回null，记得处理。所以在项目中，可以通过约定（约定大于配置），所有可能为 null 的返回值，都要返回 Optional，以此减少犯错的几率。</p>
<p>​	当然为了避免null，我们在返回的时候尽量返回一个初始化的空值，例如StringUtils.EMPTY , Lists.newArrayList()</p>
<h4 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h4><p>​	我们先来看下前面”命名”那一段的代码，我们说过有优化空间</p>
<pre><code class="java">public List&lt;ValidateRecord&gt; getValidateRecordList(String staffId)&#123;
  List&lt;Record&gt; staffRecordList = recordDao.queryAllStaffRecordList(staffId);
  
  List&lt;ValidateRecord&gt; validateRecordList = Lists.newArrayList();
  for(Record record:staffRecordList)&#123;
    if(RecordStatusEnums.VALID.getCode().equals(record.getStatus()))&#123;
      //模拟业务逻辑
      validateRecordList.add(toValidateRecord(record));
    &#125;
  &#125;
  return validateRecordList;
&#125;
</code></pre>
<p>如果按照 Java 8 之前的版本理解，这段代码是一段很正常的代码。当 Java 的时代进入到 8 之后，这段代码就成了有坏味道的代码。我们用java8的语法来重写下这段代码。</p>
<pre><code class="java">public List&lt;ValidateRecord&gt; getValidateRecordList(String staffId)&#123;
  List&lt;Record&gt; staffRecordList = recordDao.queryAllStaffRecordList(staffId);
  
  List&lt;ValidateRecord&gt; validateRecordList = staffRecordList.stream()
      .filter(Record::isValidated)
      .map(toValidateRecord(record))
      .collect(Collectors.toList());
  
  //在jdk16中可以这样写
  // List&lt;ValidateRecord&gt; validateRecordList = staffRecordList.stream()
  //	.filter(Record::isValidated)
  //	.map(toValidateRecord(record))
  //	.toList();
  
  return validateRecordList;
&#125;
</code></pre>
<p>​	或许有人会说，这段代码看着还不如我原来的循环语句简单。不过，你要知道，两种写法根本的差别是侧重点不同，循环语句是在描述实现细节，而列表转换的写法是在描述做什么，二者的抽象层次不同。</p>
<p>​	你看在java5的时候我们刚刚从下标的访问中走出来使用循环遍历的方式，到java8循环遍历的方式已经不是最优的选择了。甚至在java16中已经可以用toList();这种写法，这就是语言特性带来的变化。</p>
<p>​	当然除了没用上java8特性的这种过时写法的，也有使用函数式编程，但没用对的，存在问题的写法。</p>
<h5 id="函数式编程常见的问题"><a href="#函数式编程常见的问题" class="headerlink" title="函数式编程常见的问题"></a>函数式编程常见的问题</h5><p>​	自从 Java 里引入了 lambda，因为写起来实在是太容易了，很多人就直接在列表转换过程中写 lambda。lambda 本身相当于一个匿名函数，所以，很多人在写函数中犯的错误在 lambda 里也一样出现了，最典型的当然就是长函数。在map的转换中会犯的错误是直接写对象的转换逻辑，而不是将转换过程封装到toValidateRecord中，这里应该有个共识，最好的 lambda 应该只有一行代码。</p>
<p>​	另一个常见问题是将一个集合转化为一个映射的时候，需要处理同key的情况</p>
<pre><code class="java">List&lt;Record&gt; records  =  Lists.newArrayList();
Map&lt;String,String&gt; valMapping  = list.stream().collect(
  Collectors.toMap(Record::getId,Record::getVal,(v1, v2)-&gt;v1));
</code></pre>
<p>​	注意其中(v1, v2)-&gt;v1部分不能缺少，如果出现同key情况会抛出异常。</p>
<p>​	最后再补充下常用高频的函数式编程最重要的其实大部分就是列表转换，而最核心的列表转换就是这几个</p>
<ul>
<li>map	<ul>
<li>Map：通常用于</li>
<li>FlatMap :flatMap的可以处理更深层次的数据，入参为多个list，结果可以返回为一个list</li>
</ul>
</li>
<li>filter</li>
<li>reduce<ul>
<li>Reduce：常用于数值计算相关计算</li>
<li>Collect：各种集合的转换（toList()），另外groupingBy，joining都是比较实用的（更多可以看Collectors中的实现）</li>
<li>distinct：可以用于去重</li>
</ul>
</li>
</ul>
<h3 id="第三方库"><a href="#第三方库" class="headerlink" title="第三方库"></a>第三方库</h3><p>​	关于第三方库，我们有时候会自己实现，写出很臃肿的代码，其实已经有现成，更优雅，健壮的代码实现了。警惕重复发明轮子，</p>
<p>常用的有</p>
<ul>
<li>Apache 相关的Commons </li>
<li>Google Collections </li>
<li>阿里的easyExcel</li>
<li>…</li>
</ul>
<p>例如当我们在对数据库进行批量操作的时候，为了分散处理负载，会对一个数组进行切片，我们可以用</p>
<pre><code class="java">List&lt;Record&gt; records = queryRecords();
List&lt;List&lt;Record&gt;&gt; partitionRecords = Lists.partition(records,10);
</code></pre>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>​	我们再来简单回顾下，我们主要讨论了什么是好的代码，为什么要写好的代码，接着又讨论了什么在阻碍我们写出好的代码，怎么解决这些坏味道。</p>
<p>​	当然，怎么去写出更好的代码，这个过程应该是不断精进的，写代码是一门手艺，需要不断地打磨。</p>
<p>​	代码从写出来开始就在不断的腐烂，我们能做的就是减少腐烂带来的影响，并及时的优化。在程序员修炼之道书中提到的“破窗户理论”，即一个房子如果窗户破了，没有人去修补，隔不久其他窗户也会破，一面墙涂鸦如果没有清理，很快就会涂满整面墙。同理，代码中的坏味道如果不及时清理，后来者效仿很快就会充满整个项目。</p>
<p>​	与之相对的是“红地毯理论”，说是一个拥有完美的房子，里面都是无价古董和收藏品的富翁家里着火了，消防人员冲到房间门口却停住了，他们不想弄脏地毯。如果项目中的代码都十分漂亮—编写整洁、设计良好，并且很优雅，你就很可能格外注意不去把它弄脏。</p>
<p>​	那么什么时候该修改呢？很喜欢的一句话是</p>
<blockquote>
<p>让营地比你来时更干净。—— 童子军军规</p>
</blockquote>
<p>​	就是我们在做为后来开发维护的人，面对坏味道的代码，只要是经过你看到了，或者是交给你来维护了，都应该及时改进，每一次提交代码都比之前的代码干净，那么这个代码就会越来越干净。</p>
<p>​	作为个人平时的开发习惯是，只要有时间通常会review自己的代码，第一次实现都是会比较粗糙，通常需要修改几遍才能达到自己比较满意的状态，当然每次改进都要配合单元测试使用效果更佳。</p>
<p>​	最后，能看到这里的各位，相信对写出好的代码都是有追求，送给自己和各位一句话当共勉（2023新年快乐）</p>
<blockquote>
<p>取乎其上，得乎其中；取乎其中，得乎其下；取乎其下，则无所得矣</p>
</blockquote>
<p>参考：</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/J8pmda0HmL_MV7EbrBqsCg">一文详解｜如何写出优雅的代码</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://time.geekbang.org/column/article/341595?code=RHna5S2CQSjIpGhS2hWGv-JkpmNCcRh-19Iij98%252Fo-E%253D">代码之丑</a></p>
</li>
<li><p>《重构》</p>
</li>
<li><p>《程序员修炼之道 》</p>
</li>
<li><p>《Effective Java》</p>
</li>
<li><p>《unix编程艺术》</p>
</li>
</ul>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 951488791@qq.com </span>
    </div>
</article>



<div class="article_copyright">
    <p><span class="copy-title">文章标题:</span>工程师的自我修养</p>
    <p><span class="copy-title">字数:</span><span class="post-count">8.4k</span></p>
    <p><span class="copy-title">本文作者:</span><a  title="zhengyumin">zhengyumin</a></p>
    <p><span class="copy-title">发布时间:</span>2023-01-01, 19:52:34</p>
    <p><span class="copy-title">最后更新:</span>2023-01-03, 23:48:37</p>
    <span class="copy-title">原始链接:</span><a class="post-url" href="/2023/01/01/%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/" title="工程师的自我修养">http://zyumin.github.io/2023/01/01/%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E8%87%AA%E6%88%91%E4%BF%AE%E5%85%BB/</a>
    <p>
        <span class="copy-title">版权声明:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">&#34;署名-非商用-相同方式共享 4.0&#34;</a> 转载请保留原文链接及作者。
    </p>
</div>





    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2016-2022 zhengyumin
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().trim().split('\n').length, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
