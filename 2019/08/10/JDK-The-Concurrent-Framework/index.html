<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <title>JDK_The Concurrent Framework | Zyumin</title>
  <meta name="keywords" content=" jdk , juc ">
  <meta name="description" content="JDK_The Concurrent Framework | Zyumin">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="ä¸ºäº†å°†äº‹æƒ…åšå¥½ï¼Œé¦–å…ˆä½ å¾—å–œæ¬¢åšè¿™ä»¶äº‹ï¼Œè€Œä¸æ˜¯å–œæ¬¢è¿™ä»¶äº‹çš„ç»“æœï¼Œé‚£ä»…ä»…æ˜¯ç¬¬äºŒä½ã€‚">
<meta name="keywords" content="java">
<meta property="og:type" content="website">
<meta property="og:title" content="tags">
<meta property="og:url" content="http://yoursite.com/tags/index.html">
<meta property="og:site_name" content="Zyumin">
<meta property="og:description" content="ä¸ºäº†å°†äº‹æƒ…åšå¥½ï¼Œé¦–å…ˆä½ å¾—å–œæ¬¢åšè¿™ä»¶äº‹ï¼Œè€Œä¸æ˜¯å–œæ¬¢è¿™ä»¶äº‹çš„ç»“æœï¼Œé‚£ä»…ä»…æ˜¯ç¬¬äºŒä½ã€‚">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-03-23T07:09:56.946Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="tags">
<meta name="twitter:description" content="ä¸ºäº†å°†äº‹æƒ…åšå¥½ï¼Œé¦–å…ˆä½ å¾—å–œæ¬¢åšè¿™ä»¶äº‹ï¼Œè€Œä¸æ˜¯å–œæ¬¢è¿™ä»¶äº‹çš„ç»“æœï¼Œé‚£ä»…ä»…æ˜¯ç¬¬äºŒä½ã€‚">


<link rel="icon" href="/img/avatar.png">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/github-gist.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1"></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

<script src="/js/iconfont.js?v=1.0.1"></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value="">
</div>

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.png">
</a>
<div class="author">
    <span>zhengyumin</span>
</div>

<div class="icon">
    
        
        <a title="github" href="https://github.com/Zyumin" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"/>
                </svg>
            
        </a>
        
    
        
        <a title="neteasemusic" href="https://music.163.com/#/user/home?id=60037019" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-neteasemusic"/>
                </svg>
            
        </a>
        
    
</div>




<ul>
    <li><div class="all active">å…¨éƒ¨æ–‡ç« <small>(44)</small></div></li>
    
        
            
            <li><div data-rel="spring">spring<small>(4)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="java">java<small>(1)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="44">
<input type="hidden" id="yelog_site_word_count" value="136.6k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        å‹æƒ…é“¾æ¥
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">å¶è½é˜</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode==13){return false;}">
        <input class="search" type="text" placeholder="ä»¥ in: å¼€å¤´è¿›è¡Œå…¨æ–‡æœç´¢" autocomplete="off" id="local-search-input">
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none">
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">week</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">hide</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">jdk</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">packages</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">utils</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">java</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">note</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">jvm</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">distributed</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">zookeeper</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">framework</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">kafka</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">redis</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">netty</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">nio</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">Spec</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">thread</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">spring</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">tomcat</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">mysql</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">juc</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">classLoader</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">hotspot</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">j2ee</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">summary</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">ioc</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">lang</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">elasticsearch</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">servlet</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">io</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">serialization</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">file</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color3">gc</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">ejb</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">event</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color2">collections</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">map</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color4">doc</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color1">spring-mvc</a>
    </li>
    
    <li class="article-tag-list-item">
        <a href="javascript:" class="color5">spring-webflux</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a id="top" class="java " href="/2019/02/02/Overview_java/" data-tag="summary" data-author="">
            <span class="post-title" title="Overview_java">Overview_java</span>
            <span class="post-date" title="2019-02-02 20:43:14">2019/02/02</span>
        </a>
        
        <a id="top" class="spring " href="/2019/03/02/Overview_Spring/" data-tag="framework,spring" data-author="">
            <span class="post-title" title="Overview-Spring">Overview-Spring</span>
            <span class="post-date" title="2019-03-02 12:29:06">2019/03/02</span>
        </a>
        
        <a class="spring " href="/2019/10/29/Documentation-Spring-Core-IOC/" data-tag="spring,doc" data-author="">
            <span class="post-title" title="Documentation-Spring_Core_IOC">Documentation-Spring_Core_IOC</span>
            <span class="post-date" title="2019-10-29 21:51:07">2019/10/29</span>
        </a>
        
        <a class="" href="/2019/09/26/JDK-Packages-java-nio/" data-tag="jdk,packages,nio" data-author="">
            <span class="post-title" title="JDK_Packages_java_nio">JDK_Packages_java_nio</span>
            <span class="post-date" title="2019-09-26 10:39:22">2019/09/26</span>
        </a>
        
        <a class="" href="/2019/09/23/JDK-Packages-java-io/" data-tag="jdk,packages,io,serialization,file" data-author="">
            <span class="post-title" title="JDK_Packages_java_io">JDK_Packages_java_io</span>
            <span class="post-date" title="2019-09-23 16:07:43">2019/09/23</span>
        </a>
        
        <a class="" href="/2019/08/31/JDK-Class/" data-tag="jdk" data-author="">
            <span class="post-title" title="JDK_Class">JDK_Class</span>
            <span class="post-date" title="2019-08-31 19:38:34">2019/08/31</span>
        </a>
        
        <a class="" href="/2019/08/31/JDK-Thread/" data-tag="jdk,jvm,hotspot" data-author="">
            <span class="post-title" title="JDK_Thread">JDK_Thread</span>
            <span class="post-date" title="2019-08-31 18:16:08">2019/08/31</span>
        </a>
        
        <a class="" href="/2019/08/29/JVM-mainæ–¹æ³•åˆ†æ/" data-tag="java,jvm" data-author="">
            <span class="post-title" title="JVM_mainæ–¹æ³•åˆ†æ">JVM_mainæ–¹æ³•åˆ†æ</span>
            <span class="post-date" title="2019-08-29 23:38:13">2019/08/29</span>
        </a>
        
        <a class="" href="/2019/08/24/JDK-ReentrantLock/" data-tag="jdk,juc" data-author="">
            <span class="post-title" title="JDK_ReentrantLock">JDK_ReentrantLock</span>
            <span class="post-date" title="2019-08-24 18:48:54">2019/08/24</span>
        </a>
        
        <a class="" href="/2019/08/17/JVM-Synchronized/" data-tag="jvm" data-author="">
            <span class="post-title" title="JVM_Synchronized">JVM_Synchronized</span>
            <span class="post-date" title="2019-08-17 17:01:54">2019/08/17</span>
        </a>
        
        <a class="" href="/2019/08/11/Overview-Java-Virtual-Machine/" data-tag="jvm" data-author="">
            <span class="post-title" title="Overview_Java Virtual Machine">Overview_Java Virtual Machine</span>
            <span class="post-date" title="2019-08-11 19:05:38">2019/08/11</span>
        </a>
        
        <a class="" href="/2019/08/11/JDK-Packages-java-lang/" data-tag="jdk,packages,lang" data-author="">
            <span class="post-title" title="JDK_Packages_java_lang">JDK_Packages_java_lang</span>
            <span class="post-date" title="2019-08-11 19:04:56">2019/08/11</span>
        </a>
        
        <a class="" href="/2019/08/11/JDK-Packages-java-utils/" data-tag="jdk,packages,utils" data-author="">
            <span class="post-title" title="JDK_Packages_java_utils">JDK_Packages_java_utils</span>
            <span class="post-date" title="2019-08-11 19:04:25">2019/08/11</span>
        </a>
        
        <a class="" href="/2019/08/10/JDK-The-Concurrent-Framework/" data-tag="jdk,juc" data-author="">
            <span class="post-title" title="JDK_The Concurrent Framework">JDK_The Concurrent Framework</span>
            <span class="post-date" title="2019-08-10 19:45:39">2019/08/10</span>
        </a>
        
        <a class="" href="/2019/07/29/JDK-The-Collections-Framework/" data-tag="jdk,collections" data-author="">
            <span class="post-title" title="JDK_The Collections Framework">JDK_The Collections Framework</span>
            <span class="post-date" title="2019-07-29 15:26:01">2019/07/29</span>
        </a>
        
        <a class="" href="/2019/07/10/Note-ç å†œç¿»èº«/" data-tag="java,note" data-author="">
            <span class="post-title" title="Note_ç å†œç¿»èº«">Note_ç å†œç¿»èº«</span>
            <span class="post-date" title="2019-07-10 22:18:56">2019/07/10</span>
        </a>
        
        <a class="" href="/2019/07/06/JDK-ClassLoader/" data-tag="jdk,classLoader" data-author="">
            <span class="post-title" title="JDK_ClassLoader">JDK_ClassLoader</span>
            <span class="post-date" title="2019-07-06 23:12:51">2019/07/06</span>
        </a>
        
        <a class="spring " href="/2019/07/03/spring-webApplicationå¯åŠ¨æµç¨‹/" data-tag="spring,tomcat,classLoader,servlet,event" data-author="">
            <span class="post-title" title="spring_WebApplicationå¯åŠ¨æµç¨‹å’ŒEvent">spring_WebApplicationå¯åŠ¨æµç¨‹å’ŒEvent</span>
            <span class="post-date" title="2019-07-03 09:37:08">2019/07/03</span>
        </a>
        
        <a class="" href="/2019/06/26/Overview_Elasticsearch/" data-tag="framework,elasticsearch" data-author="">
            <span class="post-title" title="Overview_Elasticsearch">Overview_Elasticsearch</span>
            <span class="post-date" title="2019-06-26 18:06:48">2019/06/26</span>
        </a>
        
        <a class="" href="/2019/06/24/J-U-C-ConcurrentHashMap/" data-tag="juc,map" data-author="">
            <span class="post-title" title="J.U.C_ConcurrentHashMap">J.U.C_ConcurrentHashMap</span>
            <span class="post-date" title="2019-06-24 19:03:29">2019/06/24</span>
        </a>
        
        <a class="" href="/2019/06/19/JVM-Garbage-Collection/" data-tag="jvm,gc" data-author="">
            <span class="post-title" title="JVM_Garbage Collection">JVM_Garbage Collection</span>
            <span class="post-date" title="2019-06-19 00:28:10">2019/06/19</span>
        </a>
        
        <a class="" href="/2019/06/16/J-U-C-InterruptedException/" data-tag="juc" data-author="">
            <span class="post-title" title="J.U.C_InterruptedException">J.U.C_InterruptedException</span>
            <span class="post-date" title="2019-06-16 16:09:43">2019/06/16</span>
        </a>
        
        <a class="" href="/2019/06/14/Spec-JSR133/" data-tag="jvm,Spec,thread" data-author="">
            <span class="post-title" title="Spec_JSR133">Spec_JSR133</span>
            <span class="post-date" title="2019-06-14 19:26:57">2019/06/14</span>
        </a>
        
        <a class="" href="/2019/06/13/Overview_JDK/" data-tag="jdk,hotspot" data-author="">
            <span class="post-title" title="JDKæ·±å…¥æµ…å‡º">JDKæ·±å…¥æµ…å‡º</span>
            <span class="post-date" title="2019-06-13 19:36:54">2019/06/13</span>
        </a>
        
        <a class="" href="/2019/06/13/Spec-Java-Virtual-Machine/" data-tag="jvm,Spec" data-author="">
            <span class="post-title" title="Spec_Java Virtual Machine">Spec_Java Virtual Machine</span>
            <span class="post-date" title="2019-06-13 17:25:17">2019/06/13</span>
        </a>
        
        <a class="" href="/2019/06/12/Overview_Kafka/" data-tag="framework,kafka" data-author="">
            <span class="post-title" title="kafkaæ·±å…¥æµ…å‡º">kafkaæ·±å…¥æµ…å‡º</span>
            <span class="post-date" title="2019-06-12 20:05:37">2019/06/12</span>
        </a>
        
        <a class="" href="/2019/06/10/Overview_Redis/" data-tag="framework,redis" data-author="">
            <span class="post-title" title="redisæ·±å…¥æµ…å‡º">redisæ·±å…¥æµ…å‡º</span>
            <span class="post-date" title="2019-06-10 18:33:40">2019/06/10</span>
        </a>
        
        <a class="" href="/2019/06/06/Note_javaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯/" data-tag="java,note,juc" data-author="">
            <span class="post-title" title="Note_javaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯">Note_javaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯</span>
            <span class="post-date" title="2019-06-06 19:05:01">2019/06/06</span>
        </a>
        
        <a class="" href="/2019/06/05/Overview_Netty/" data-tag="framework,netty,nio" data-author="">
            <span class="post-title" title="Nettyæ·±å…¥æµ…å‡º">Nettyæ·±å…¥æµ…å‡º</span>
            <span class="post-date" title="2019-06-05 22:01:31">2019/06/05</span>
        </a>
        
        <a class="" href="/2019/06/05/Note_æ·±å…¥ç†è§£javaè™šæ‹Ÿæœº/" data-tag="java,note,jvm" data-author="">
            <span class="post-title" title="Note_æ·±å…¥ç†è§£javaè™šæ‹Ÿæœº">Note_æ·±å…¥ç†è§£javaè™šæ‹Ÿæœº</span>
            <span class="post-date" title="2019-06-05 21:12:25">2019/06/05</span>
        </a>
        
        <a class="" href="/2019/06/04/Overview_MySQL/" data-tag="mysql" data-author="">
            <span class="post-title" title="MySQLæ·±å…¥æµ…å‡º">MySQLæ·±å…¥æµ…å‡º</span>
            <span class="post-date" title="2019-06-04 22:02:31">2019/06/04</span>
        </a>
        
        <a class="" href="/2019/06/03/Overview_Zookeeper/" data-tag="distributed,zookeeper,framework" data-author="">
            <span class="post-title" title="Zookeeperæ·±å…¥æµ…å‡º">Zookeeperæ·±å…¥æµ…å‡º</span>
            <span class="post-date" title="2019-06-03 21:15:05">2019/06/03</span>
        </a>
        
        <a class="" href="/2019/06/03/Overview_Distributed/" data-tag="distributed" data-author="">
            <span class="post-title" title="åˆ†å¸ƒå¼ç†è®ºåŸºç¡€">åˆ†å¸ƒå¼ç†è®ºåŸºç¡€</span>
            <span class="post-date" title="2019-06-03 20:34:37">2019/06/03</span>
        </a>
        
        <a class="" href="/2019/04/10/spring-api-1-0/" data-tag="spring" data-author="">
            <span class="post-title" title="spring-api-1.0">spring-api-1.0</span>
            <span class="post-date" title="2019-04-10 09:45:25">2019/04/10</span>
        </a>
        
        <a class="" href="/2019/04/01/3æœˆç¬¬å››å‘¨çŸ¥è¯†ç‚¹è®°å½•/" data-tag="week,hide" data-author="">
            <span class="post-title" title="3æœˆç¬¬å››å‘¨çŸ¥è¯†ç‚¹è®°å½•">3æœˆç¬¬å››å‘¨çŸ¥è¯†ç‚¹è®°å½•</span>
            <span class="post-date" title="2019-04-01 09:51:07">2019/04/01</span>
        </a>
        
        <a class="" href="/2019/03/30/è®°ä¸€æ¬¡mysqlæŸ¥è¯¢inçš„æ€è€ƒ/" data-tag="mysql" data-author="">
            <span class="post-title" title="è®°ä¸€æ¬¡mysqlæŸ¥è¯¢inçš„æ€è€ƒ">è®°ä¸€æ¬¡mysqlæŸ¥è¯¢inçš„æ€è€ƒ</span>
            <span class="post-date" title="2019-03-30 20:39:49">2019/03/30</span>
        </a>
        
        <a class="" href="/2019/03/26/è®°ä¸€æ¬¡Broken-pipeé—®é¢˜çš„æ€è€ƒ/" data-tag="tomcat" data-author="">
            <span class="post-title" title="è®°ä¸€æ¬¡Broken pipeé—®é¢˜çš„æ€è€ƒ">è®°ä¸€æ¬¡Broken pipeé—®é¢˜çš„æ€è€ƒ</span>
            <span class="post-date" title="2019-03-26 10:53:37">2019/03/26</span>
        </a>
        
        <a class="" href="/2019/03/24/3æœˆç¬¬ä¸‰å‘¨çŸ¥è¯†ç‚¹è®°å½•/" data-tag="week" data-author="">
            <span class="post-title" title="3æœˆç¬¬ä¸‰å‘¨çŸ¥è¯†ç‚¹è®°å½•">3æœˆç¬¬ä¸‰å‘¨çŸ¥è¯†ç‚¹è®°å½•</span>
            <span class="post-date" title="2019-03-24 20:55:31">2019/03/24</span>
        </a>
        
        <a class="" href="/2019/03/10/Note_Expert One-on-One-J2EE-Development-without-EJB/" data-tag="spring,j2ee,ejb" data-author="">
            <span class="post-title" title="Expert One-on-One J2EE Development without EJB">Expert One-on-One J2EE Development without EJB</span>
            <span class="post-date" title="2019-03-10 19:45:57">2019/03/10</span>
        </a>
        
        <a class="" href="/2019/03/10/Note_Expert-One-on-One-J2EE-Design-and-Development/" data-tag="spring,j2ee" data-author="">
            <span class="post-title" title="Expert One-on-One J2EE Design and Development">Expert One-on-One J2EE Design and Development</span>
            <span class="post-date" title="2019-03-10 19:45:18">2019/03/10</span>
        </a>
        
        <a class="spring " href="/2019/03/03/spring-ioc/" data-tag="spring,ioc" data-author="">
            <span class="post-title" title="spring-ioc">spring-ioc</span>
            <span class="post-date" title="2019-03-03 14:51:56">2019/03/03</span>
        </a>
        
        <a class="" href="/2019/02/03/spring-mvc/" data-tag="spring,servlet,spring-mvc,spring-webflux" data-author="">
            <span class="post-title" title="servlet_spring-mvc">servlet_spring-mvc</span>
            <span class="post-date" title="2019-02-03 15:50:16">2019/02/03</span>
        </a>
        
        <a class="" href="/2019/02/03/Overview_Tomcat/" data-tag="tomcat,servlet" data-author="">
            <span class="post-title" title="servlet_tomcat">servlet_tomcat</span>
            <span class="post-date" title="2019-02-03 15:49:08">2019/02/03</span>
        </a>
        
        <a class="" href="/2019/02/02/Spec_Servlet/" data-tag="j2ee,servlet" data-author="">
            <span class="post-title" title="j2ee_servlet">j2ee_servlet</span>
            <span class="post-date" title="2019-02-02 18:05:54">2019/02/02</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-JDK-The-Concurrent-Framework" class="article article-type-post" itemscope="" itemprop="blogPost">
    
        <h1 class="article-title">JDK_The Concurrent Framework</h1>
    
    <div class="article-meta">
        
        
        
        
        <span class="tag">
            
            <a href="javascript:" class="color4">jdk</a>
            
            <a href="javascript:" class="color4">juc</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        åˆ›å»ºæ—¶é—´:<time class="date" title="æ›´æ–°æ—¶é—´: 2019-08-24 18:57:12">2019-08-10 19:45</time>
        
    </div>
    <div class="article-meta">
        
        <span>å­—æ•°:8.8k</span>
        
        
        <span id="busuanzi_container_page_pv">
            é˜…è¯»:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Preface"><span class="toc-text">Preface</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java-util-concurrent"><span class="toc-text">java.util.concurrent</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Executors"><span class="toc-text">Executors</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Executor"><span class="toc-text">Executor</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ExecutorService"><span class="toc-text">ExecutorService</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ScheduledExecutorService"><span class="toc-text">ScheduledExecutorService</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Callable"><span class="toc-text">Callable</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Future"><span class="toc-text">Future</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#RunnableFuture"><span class="toc-text">RunnableFuture</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ThreadFactory"><span class="toc-text">ThreadFactory</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ThreadPoolExecutor-amp-ScheduledThreadPoolExecutor"><span class="toc-text">ThreadPoolExecutor &amp; ScheduledThreadPoolExecutor</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Executors-1"><span class="toc-text">Executors</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#FutureTask-amp-ExecutorCompletionService"><span class="toc-text">FutureTask &amp; ExecutorCompletionService</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ForkJoinPool-amp-ForkJoinTask-amp-ForkJoinWorkerThread-since-1-7"><span class="toc-text">ForkJoinPool &amp; ForkJoinTask &amp; ForkJoinWorkerThread(@since 1.7)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Queues"><span class="toc-text">Queues</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#BlockingQueue"><span class="toc-text">BlockingQueue</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#BlockingDeque-since-1-6-amp-TransferQueue-since-1-7"><span class="toc-text">BlockingDeque(@since 1.6) &amp; TransferQueue(@since 1.7)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#LinkedBlockingQueue"><span class="toc-text">LinkedBlockingQueue</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ArrayBlockingQueue"><span class="toc-text">ArrayBlockingQueue</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#SynchronousQueue"><span class="toc-text">SynchronousQueue</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PriorityBlockingQueue"><span class="toc-text">PriorityBlockingQueue</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#DelayQueue"><span class="toc-text">DelayQueue.</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Timing"><span class="toc-text">Timing</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Synchronizers"><span class="toc-text">Synchronizers</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Semaphore"><span class="toc-text">Semaphore</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CountDownLatch"><span class="toc-text">CountDownLatch</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CyclicBarrier"><span class="toc-text">CyclicBarrier</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Phaser-since-1-7"><span class="toc-text">Phaser(@since 1.7)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Exchanger"><span class="toc-text">Exchanger</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Concurrent-Collections"><span class="toc-text">Concurrent Collections</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ConcurrentHashMap"><span class="toc-text">ConcurrentHashMap</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ConcurrentSkipListMap"><span class="toc-text">ConcurrentSkipListMap</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ConcurrentSkipListSet"><span class="toc-text">ConcurrentSkipListSet</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CopyOnWriteArrayList"><span class="toc-text">CopyOnWriteArrayList</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CopyOnWriteArraySet"><span class="toc-text">CopyOnWriteArraySet</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Memory-Consistency-Properties-å†…å­˜ä¸€è‡´æ€§"><span class="toc-text">Memory Consistency Properties (å†…å­˜ä¸€è‡´æ€§)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java-util-concurrent-atomic"><span class="toc-text">java.util.concurrent.atomic</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Atomic-Values"><span class="toc-text">Atomic Values</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Atomic-Fields"><span class="toc-text">Atomic Fields</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Atomic-Arrays"><span class="toc-text">Atomic Arrays</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Class-Summary"><span class="toc-text">Class Summary</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Designed"><span class="toc-text">Designed</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java-util-concurrent-locks"><span class="toc-text">java.util.concurrent.locks</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Locks-é”"><span class="toc-text">Locks(é”)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Lock"><span class="toc-text">Lock</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Lockä¸synchronizedçš„å¼‚åŒ"><span class="toc-text">Lockä¸synchronizedçš„å¼‚åŒ</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Implementation-Considerations"><span class="toc-text">Implementation Considerations</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ReentrantLock"><span class="toc-text">ReentrantLock</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ReadWriteLock"><span class="toc-text">ReadWriteLock</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ReentrantReadWriteLock"><span class="toc-text">ReentrantReadWriteLock</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Conditions-ç›‘è§†å™¨"><span class="toc-text">Conditions(ç›‘è§†å™¨)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AbstractQueuedSynchronizers-é˜»å¡é˜Ÿåˆ—"><span class="toc-text">AbstractQueuedSynchronizers(é˜»å¡é˜Ÿåˆ—)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#AbstractQueuedSynchronizer"><span class="toc-text">AbstractQueuedSynchronizer</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#Usage"><span class="toc-text">Usage</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AbstractQueuedLongSynchronizer"><span class="toc-text">AbstractQueuedLongSynchronizer</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#AbstractOwnableSynchronizer"><span class="toc-text">AbstractOwnableSynchronizer</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LockSupports"><span class="toc-text">LockSupports</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RecordğŸ“"><span class="toc-text">RecordğŸ“</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-4 i,
    .toc-level-4 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://ww4.sinaimg.cn/large/006tNc79gy1g5utotuddmj30f409gjrs.jpg" alt="img"></p>
<a id="more"></a>
<h3 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h3><p><img src="http://ww4.sinaimg.cn/large/006y8mN6gy1g6740ptmguj30lw0g0acz.jpg" alt="image-20190820172914051"></p>
<p>CASå®ç° ã€volatileè¯­æ„  -&gt; AQS(AbstractQueuedSynchronizer)</p>
<h3 id="java-util-concurrent"><a href="#java-util-concurrent" class="headerlink" title="java.util.concurrent"></a>java.util.concurrent</h3><p>Utility classes commonly useful in concurrent programming.This package includes a few small standardized extensible frameworks, as well as some classes that provide useful functionality and are otherwise tedious or difficult to implement.</p>
<p>å®ç”¨ç¨‹åºç±»é€šå¸¸ç”¨äºå¹¶å‘ç¼–ç¨‹ã€‚è¿™ä¸ªåŒ…, åŒ…æ‹¬ä¸€äº›å°å‹çš„æ ‡å‡†åŒ–å¯æ‰©å±•æ¡†æ¶ï¼Œä»¥åŠä¸€äº›æä¾›æœ‰ç”¨åŠŸèƒ½çš„ç±»ï¼Œé€šå¸¸è¿™äº›ç±»æ˜¯å•è°ƒä¹å‘³æˆ–éš¾ä»¥å®ç°çš„ã€‚</p>
<h4 id="Executors"><a href="#Executors" class="headerlink" title="Executors"></a>Executors</h4><p><img src="http://ww4.sinaimg.cn/large/006tNc79gy1g62o7n38t1j324d0u0gt9.jpg" alt="image-20190817144324388"></p>
<p><strong>Interfaces</strong></p>
<h5 id="Executor"><a href="#Executor" class="headerlink" title="Executor"></a>Executor</h5><p> <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executor.html" target="_blank" rel="noopener"><code>Executor</code></a> is a simple standardized interface for defining custom thread-like subsystems, including thread pools, asynchronous I/O, and lightweight task frameworks. </p>
<p>Depending on which concrete Executor class is being used, tasks may execute in a newly created thread, an existing task-execution thread, or the thread calling <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executor.html#execute-java.lang.Runnable-" target="_blank" rel="noopener"><code>execute</code></a>, and may execute sequentially or concurrently.</p>
<pre><code class="java">public interface Executor {
    void execute(Runnable command);
}
</code></pre>
<h5 id="ExecutorService"><a href="#ExecutorService" class="headerlink" title="ExecutorService"></a>ExecutorService</h5><p><img src="http://ww2.sinaimg.cn/large/006tNc79gy1g62obzhq7nj31ds0sujwc.jpg" alt="image-20190817144736755"></p>
<p><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html" target="_blank" rel="noopener"><code>ExecutorService</code></a> provides a more complete asynchronous task execution framework. An ExecutorService manages queuing and scheduling of tasks, and allows controlled shutdown. </p>
<pre><code class="java">public interface ExecutorService extends Executor {
   void shutdown();
   List&lt;Runnable&gt; shutdownNow();
   boolean isShutdown();
   boolean isTerminated();
   boolean awaitTermination(long timeout, TimeUnit unit)
        throws InterruptedException;
   &lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task);
   &lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result);
   Future&lt;?&gt; submit(Runnable task);
   &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)
        throws InterruptedException;
   &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,
                                  long timeout, TimeUnit unit)
        throws InterruptedException;
   &lt;T&gt; T invokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)
        throws InterruptedException, ExecutionException;
   &lt;T&gt; T invokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,long timeout, TimeUnit unit)
        throws InterruptedException, ExecutionException, TimeoutException;
}
</code></pre>
<p>ä¸åŒäºsubmit</p>
<p>æ–¹æ³•invokeAny,invokeAllå…·æœ‰é˜»å¡æ€§ã€‚</p>
<ul>
<li>invokeAnyå–å¾—ç¬¬ä¸€ä¸ªæ–¹æ³•çš„è¿”å›å€¼,å½“ç¬¬ä¸€ä¸ªä»»åŠ¡ç»“æŸåï¼Œä¼šè°ƒç”¨interruptæ–¹æ³•ä¸­æ–­å…¶å®ƒä»»åŠ¡ã€‚</li>
<li>invokeAllç­‰çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œæ¯•å,å–å¾—å…¨éƒ¨ä»»åŠ¡çš„ç»“æœå€¼ã€‚</li>
</ul>
<h5 id="ScheduledExecutorService"><a href="#ScheduledExecutorService" class="headerlink" title="ScheduledExecutorService"></a>ScheduledExecutorService</h5><p>The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ScheduledExecutorService.html" target="_blank" rel="noopener"><code>ScheduledExecutorService</code></a> subinterface and associated interfaces add support for delayed and periodic task execution. </p>
<pre><code class="java">public interface ScheduledExecutorService extends ExecutorService {
   public ScheduledFuture&lt;?&gt; schedule(Runnable command,long delay, TimeUnit unit);
   public &lt;V&gt; ScheduledFuture&lt;V&gt; schedule(Callable&lt;V&gt; callable,long delay, TimeUnit unit);
   public ScheduledFuture&lt;?&gt; scheduleAtFixedRate(Runnable command,
                                                  long initialDelay,
                                                  long period,
                                                  TimeUnit unit);
  public ScheduledFuture&lt;?&gt; scheduleWithFixedDelay(Runnable command,
                                                     long initialDelay,
                                                     long delay,
                                                     TimeUnit unit);
}
</code></pre>
<h5 id="Callable"><a href="#Callable" class="headerlink" title="Callable"></a>Callable</h5><p> ExecutorServices provide methods arranging asynchronous execution of any function expressed as <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html" target="_blank" rel="noopener"><code>Callable</code></a>, the result-bearing analog of <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html" target="_blank" rel="noopener"><code>Runnable</code></a></p>
<pre><code class="java">@FunctionalInterface
public interface Callable&lt;V&gt; {
    /**
     * Computes a result, or throws an exception if unable to do so.
     *
     * @return computed result
     * @throws Exception if unable to compute a result
     */
    V call() throws Exception;
}
</code></pre>
<h5 id="Future"><a href="#Future" class="headerlink" title="Future"></a>Future</h5><p>A <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html" target="_blank" rel="noopener"><code>Future</code></a> returns the results of a function, allows determination of whether execution has completed, and provides a means to cancel execution.</p>
<pre><code class="java">public interface Future&lt;V&gt; {
    boolean cancel(boolean mayInterruptIfRunning);
    boolean isCancelled();
    boolean isDone(); 
    V get() throws InterruptedException, ExecutionException;
    V get(long timeout, TimeUnit unit)
        throws InterruptedException, ExecutionException, TimeoutException;
}
</code></pre>
<h5 id="RunnableFuture"><a href="#RunnableFuture" class="headerlink" title="RunnableFuture"></a>RunnableFuture</h5><p>A <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/RunnableFuture.html" target="_blank" rel="noopener"><code>RunnableFuture</code></a> is a <code>Future</code> that possesses a <code>run</code> method that upon execution, sets its results.</p>
<pre><code class="java">public interface RunnableFuture&lt;V&gt; extends Runnable, Future&lt;V&gt; {
    /**
     * Sets this Future to the result of its computation
     * unless it has been cancelled.
     */
    void run();
}
</code></pre>
<h5 id="ThreadFactory"><a href="#ThreadFactory" class="headerlink" title="ThreadFactory"></a>ThreadFactory</h5><pre><code class="java">public interface ThreadFactory {

    /**
     * Constructs a new {@code Thread}.  Implementations may also initialize
     * priority, name, daemon status, {@code ThreadGroup}, etc.
     *
     * @param r a runnable to be executed by new thread instance
     * @return constructed thread, or {@code null} if the request to
     *         create a thread is rejected
     */
    Thread newThread(Runnable r);
}
</code></pre>
<p>æ„é€ æ–°çš„çº¿ç¨‹,åˆå§‹åŒ– ä¼˜å…ˆçº§ ã€åå­— ç­‰</p>
<p><strong>Implementations</strong> </p>
<h5 id="ThreadPoolExecutor-amp-ScheduledThreadPoolExecutor"><a href="#ThreadPoolExecutor-amp-ScheduledThreadPoolExecutor" class="headerlink" title="ThreadPoolExecutor &amp; ScheduledThreadPoolExecutor"></a>ThreadPoolExecutor &amp; ScheduledThreadPoolExecutor</h5><pre><code class="java">public class ThreadPoolExecutor extends AbstractExecutorService {
     /**
     * The main pool control state, ctl, is an atomic integer packing
     * two conceptual fields
     *   workerCount, indicating the effective number of threads
     *   runState,    indicating whether running, shutting down etc
     */
    private final class Worker extends AbstractQueuedSynchronizer implements Runnable{...}
    public static class xxx implements rejectedExecution{...}
    implements Executor{..}
    implements ExecutorService{..}
    ...
}
</code></pre>
<p>â€‹    è¿™ä¸ªç±»å¾ˆæœ‰æ„æ€å‘€,åŒ…å«äº†è¿è¡ŒçŠ¶æ€,workeræ•°é‡çš„è®¡ç®—,  Workerçš„å®ç°,æ‹’ç»ç­–ç•¥çš„å®ç°,Executorçš„å®ç°,å¦å¤–æ³¨æ„æ„é€ å‡½æ•°,æ³¨æ„ç†è§£å„ä¸ªå‚æ•°çš„å«ä¹‰âš ï¸</p>
<pre><code class="java">public class ScheduledThreadPoolExecutor extends ThreadPoolExecutor
        implements ScheduledExecutorService {
    /*
     * This class specializes ThreadPoolExecutor implementation by
     *
     * 1. Using a custom task type, ScheduledFutureTask for
     *    tasks, even those that don&#39;t require scheduling (i.e.,
     *    those submitted using ExecutorService execute, not
     *    ScheduledExecutorService methods) which are treated as
     *    delayed tasks with a delay of zero.
     *
     * 2. Using a custom queue (DelayedWorkQueue), a variant of
     *    unbounded DelayQueue. The lack of capacity constraint and
     *    the fact that corePoolSize and maximumPoolSize are
     *    effectively identical simplifies some execution mechanics
     *    (see delayedExecute) compared to ThreadPoolExecutor.
     *
     * 3. Supporting optional run-after-shutdown parameters, which
     *    leads to overrides of shutdown methods to remove and cancel
     *    tasks that should NOT be run after shutdown, as well as
     *    different recheck logic when task (re)submission overlaps
     *    with a shutdown.
     *
     * 4. Task decoration methods to allow interception and
     *    instrumentation, which are needed because subclasses cannot
     *    otherwise override submit methods to get this effect. These
     *    don&#39;t have any impact on pool control logic though.
     */
     ...
}
</code></pre>
<p>â€‹    ä¸ThreadPoolExecutorä¸åŒçš„æ˜¯,ä½¿ç”¨çš„æ˜¯task,å»¶è¿Ÿé˜Ÿåˆ—,é‡å†™äº†onshutdown</p>
<h5 id="Executors-1"><a href="#Executors-1" class="headerlink" title="Executors"></a>Executors</h5><p>The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html" target="_blank" rel="noopener"><code>Executors</code></a> class provides factory methods for the most common kinds and configurations of Executors, as well as a few utility methods for using them. </p>
<p>ç±»ä¼¼äºCollections, Executorsç±»ä¸ºæœ€å¸¸è§çš„executorç±»å‹å’Œé…ç½®æä¾›å·¥å‚æ–¹æ³•ï¼Œä»¥åŠä¸€äº›ä½¿ç”¨å®ƒä»¬çš„å®ç”¨ç¨‹åºæ–¹æ³•ã€‚</p>
<h5 id="FutureTask-amp-ExecutorCompletionService"><a href="#FutureTask-amp-ExecutorCompletionService" class="headerlink" title="FutureTask &amp; ExecutorCompletionService"></a>FutureTask &amp; ExecutorCompletionService</h5><p>Other utilities based on <code>Executors</code> include the concrete class <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/FutureTask.html" target="_blank" rel="noopener"><code>FutureTask</code></a> providing a common extensible implementation of Futures, and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorCompletionService.html" target="_blank" rel="noopener"><code>ExecutorCompletionService</code></a>, that assists in coordinating the processing of groups of asynchronous tasks.</p>
<p>åŸºäºexecutorçš„å…¶ä»–å®ç”¨ç¨‹åºåŒ…æ‹¬æä¾›futureå…¬å…±å¯æ‰©å±•å®ç°çš„å…·ä½“ç±»FutureTaskå’ŒExecutorCompletionServiceï¼Œåè€…å¸®åŠ©åè°ƒå¼‚æ­¥ä»»åŠ¡ç»„çš„å¤„ç†ã€‚</p>
<h5 id="ForkJoinPool-amp-ForkJoinTask-amp-ForkJoinWorkerThread-since-1-7"><a href="#ForkJoinPool-amp-ForkJoinTask-amp-ForkJoinWorkerThread-since-1-7" class="headerlink" title="ForkJoinPool &amp; ForkJoinTask &amp; ForkJoinWorkerThread(@since 1.7)"></a>ForkJoinPool &amp; ForkJoinTask &amp; ForkJoinWorkerThread(@since 1.7)</h5><p>ForkJoinPoolçš„ä¼˜åŠ¿åœ¨äºï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨å¤šcpuï¼Œå¤šæ ¸cpuçš„ä¼˜åŠ¿ï¼ŒæŠŠä¸€ä¸ªä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªâ€œå°ä»»åŠ¡â€ï¼ŒæŠŠå¤šä¸ªâ€œå°ä»»åŠ¡â€æ”¾åˆ°å¤šä¸ªå¤„ç†å™¨æ ¸å¿ƒä¸Šå¹¶è¡Œæ‰§è¡Œï¼›å½“å¤šä¸ªâ€œå°ä»»åŠ¡â€æ‰§è¡Œå®Œæˆä¹‹åï¼Œå†å°†è¿™äº›æ‰§è¡Œç»“æœåˆå¹¶èµ·æ¥å³å¯ã€‚</p>
<p><img src="http://ww4.sinaimg.cn/large/006tNc79gy1g5utn9m71kj317y0tutgr.jpg" alt="image-20190810194656530"></p>
<h4 id="Queues"><a href="#Queues" class="headerlink" title="Queues"></a>Queues</h4><p><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g62ogwi8q8j32fw0gm0v5.jpg" alt="image-20190817145220963"></p>
<h5 id="BlockingQueue"><a href="#BlockingQueue" class="headerlink" title="BlockingQueue"></a>BlockingQueue</h5><p>A <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Queue.html" target="_blank" rel="noopener"><code>Queue</code></a> that additionally supports operations that wait for the queue to become non-empty when retrieving an element, and wait for space to become available in the queue when storing an element.</p>
<p><code>BlockingQueue</code> methods come in four forms, with different ways of handling operations that cannot be satisfied immediately, but may be satisfied at some point in the future: </p>
<p>one throws an exception, </p>
<p>the second returns a special value (either <code>null</code> or <code>false</code>, depending on the operation),</p>
<p>the third blocks the current thread indefinitely until the operation can succeed, </p>
<p>and the fourth blocks for only a given maximum time limit before giving up. </p>
<p>These methods are summarized in the following table:</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left"><em>Throws exception</em></th>
<th style="text-align:left"><em>Special value</em></th>
<th style="text-align:left"><em>Blocks</em></th>
<th style="text-align:left"><em>Times out</em></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>Insert</strong></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html#add-E-" target="_blank" rel="noopener"><code>add(e)</code></a></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html#offer-E-" target="_blank" rel="noopener"><code>offer(e)</code></a></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html#put-E-" target="_blank" rel="noopener"><code>put(e)</code></a></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html#offer-E-long-java.util.concurrent.TimeUnit-" target="_blank" rel="noopener"><code>offer(e, time, unit)</code></a></td>
</tr>
<tr>
<td style="text-align:left"><strong>Remove</strong></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html#remove-java.lang.Object-" target="_blank" rel="noopener"><code>remove()</code></a></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html#poll-long-java.util.concurrent.TimeUnit-" target="_blank" rel="noopener"><code>poll()</code></a></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html#take--" target="_blank" rel="noopener"><code>take()</code></a></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html#poll-long-java.util.concurrent.TimeUnit-" target="_blank" rel="noopener"><code>poll(time, unit)</code></a></td>
</tr>
<tr>
<td style="text-align:left"><strong>Examine</strong></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Queue.html#element--" target="_blank" rel="noopener"><code>element()</code></a></td>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/Queue.html#peek--" target="_blank" rel="noopener"><code>peek()</code></a></td>
<td style="text-align:left"><em>not applicable</em></td>
<td style="text-align:left"><em>not applicable</em></td>
</tr>
</tbody>
</table>
<pre><code class="java">public interface BlockingQueue&lt;E&gt; extends Queue&lt;E&gt; {
    /*
     * imple Queue
     */
    boolean add(E e);
    boolean offer(E e);
    /*
     * imple Collection
     */
    boolean remove(Object o);
    public boolean contains(Object o);
    /*
     * BlockingQueue methods  put take 
     */
    void put(E e) throws InterruptedException;
    boolean offer(E e, long timeout, TimeUnit unit)
        throws InterruptedException;
    /*
     * Retrieves and removes the head of this queue
     */
    E take() throws InterruptedException;
    E poll(long timeout, TimeUnit unit)
        throws InterruptedException;

}
</code></pre>
<p>â€‹    å®ç°äº†Queueæ¥å£ , è€ŒQueueæ¥å£åˆå®ç°äº†Collection,  è€ŒBlockingQueue æ–°å¢çš„æœ‰é˜»å¡å¼çš„ putå’Œtake ,</p>
<p>æä¾›é˜»å¡è¶…æ—¶æœºåˆ¶çš„, offerã€poll(æ‰©å±•äº†Queueçš„æ–¹æ³•)</p>
<h5 id="BlockingDeque-since-1-6-amp-TransferQueue-since-1-7"><a href="#BlockingDeque-since-1-6-amp-TransferQueue-since-1-7" class="headerlink" title="BlockingDeque(@since 1.6) &amp; TransferQueue(@since 1.7)"></a>BlockingDeque(@since 1.6) &amp; TransferQueue(@since 1.7)</h5><p>BlockingDequeä¸BlockingQueueç±»ä¼¼</p>
<p>LinkedBlockingDeque</p>
<p>The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingDeque.html" target="_blank" rel="noopener"><code>BlockingDeque</code></a> interface extends <code>BlockingQueue</code> to support both FIFO and LIFO (stack-based) operations.</p>
<pre><code class="java">public interface BlockingDeque&lt;E&gt; extends BlockingQueue&lt;E&gt;, Deque&lt;E&gt; {
    ...
    void putFirst(E e) throws InterruptedException;
    void putLast(E e) throws InterruptedException;
    E takeFirst() throws InterruptedException;
    E takeLast() throws InterruptedException;
    ...
}
</code></pre>
<p>TransferQueue </p>
<p> <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/LinkedTransferQueue.html" target="_blank" rel="noopener"><code>LinkedTransferQueue</code></a> introduce a synchronous <code>transfer</code> method (along with related features) in which a producer may optionally block awaiting its consumer</p>
<blockquote>
<p>TransferQueueæ˜¯ä¸€ä¸ªèªæ˜çš„é˜Ÿåˆ—ï¼Œå®ƒæ˜¯ConcurrentLinkedQueue, SynchronousQueue (åœ¨å…¬å¹³æ¨¡å¼ä¸‹), æ— ç•Œçš„LinkedBlockingQueuesç­‰çš„è¶…é›†ã€‚</p>
</blockquote>
<p>ğŸŒŸè¿™æ˜¯ä¸ªå¾ˆå‰å®³çš„é˜Ÿåˆ—~ åªæœ‰åœ¨æ¶ˆè´¹è€…ç­‰å¾…çš„æƒ…å†µä¸‹æ‰ä¼šç”Ÿäº§,  è§£å†³æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…é€Ÿåº¦ä¸åŒ¹é…çš„é—®é¢˜, ä¾‹å¦‚ out of memory .</p>
<p>@see <a href="https://segmentfault.com/a/1190000011266361" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011266361</a></p>
<p><strong>Implementations.</strong> </p>
<p>Five implementations in <code>java.util.concurrent</code> support the extended <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/BlockingQueue.html" target="_blank" rel="noopener"><code>BlockingQueue</code></a> interface, that defines blocking versions of put and take: <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/LinkedBlockingQueue.html" target="_blank" rel="noopener"><code>LinkedBlockingQueue</code></a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ArrayBlockingQueue.html" target="_blank" rel="noopener"><code>ArrayBlockingQueue</code></a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/SynchronousQueue.html" target="_blank" rel="noopener"><code>SynchronousQueue</code></a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/PriorityBlockingQueue.html" target="_blank" rel="noopener"><code>PriorityBlockingQueue</code></a>, and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/DelayQueue.html" target="_blank" rel="noopener"><code>DelayQueue</code></a>. The different classes cover the most common usage contexts for producer-consumer, messaging, parallel tasking, and related concurrent designs.</p>
<h5 id="LinkedBlockingQueue"><a href="#LinkedBlockingQueue" class="headerlink" title="LinkedBlockingQueue"></a>LinkedBlockingQueue</h5><p>æœ‰é™é˜»å¡é˜Ÿåˆ—,åº•å±‚å­˜å‚¨é“¾è¡¨ç»“æ„, å¯ä»¥ä¸æŒ‡å®šå¤§å°, é»˜è®¤Integer.MAX_VALUE</p>
<h5 id="ArrayBlockingQueue"><a href="#ArrayBlockingQueue" class="headerlink" title="ArrayBlockingQueue"></a>ArrayBlockingQueue</h5><p>æœ‰é™é˜»å¡é˜Ÿåˆ—,åº•å±‚å­˜å‚¨æ˜¯æ•°ç»„,éœ€è¦æŒ‡å®šå¤§å°åˆå§‹åŒ– , å¦ä¸€ä¸ªæ˜¯å¯ä»¥æŒ‡å®šReentrantLockå…¬å¹³é”æˆ–è€…éå…¬å¹³é”</p>
<h5 id="SynchronousQueue"><a href="#SynchronousQueue" class="headerlink" title="SynchronousQueue"></a>SynchronousQueue</h5><p>æ˜¯ä¸€ä¸ªç©ºé˜Ÿåˆ—,ç”¨äºä¼ é€’æ•°æ®</p>
<p>SynchronousQueueä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—ï¼ˆä¸€ä¸ªç”¨äºæ­£åœ¨ç­‰å¾…çš„ç”Ÿäº§è€…ã€å¦ä¸€ä¸ªç”¨äºæ­£åœ¨ç­‰å¾…çš„æ¶ˆè´¹è€…ï¼‰å’Œä¸€ä¸ªç”¨æ¥ä¿æŠ¤ä¸¤ä¸ªé˜Ÿåˆ—çš„é”ã€‚è€ŒLinkedTransferQueueä½¿ç”¨CASæ“ä½œå®ç°ä¸€ä¸ªéé˜»å¡çš„æ–¹æ³•ï¼Œè¿™æ˜¯é¿å…åºåˆ—åŒ–å¤„ç†ä»»åŠ¡çš„å…³é”®ã€‚</p>
<p>@see <a href="https://segmentfault.com/a/1190000011207824" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011207824</a></p>
<h5 id="PriorityBlockingQueue"><a href="#PriorityBlockingQueue" class="headerlink" title="PriorityBlockingQueue"></a>PriorityBlockingQueue</h5><p>ä¼˜å…ˆçº§é˜Ÿåˆ—, å®ç°ä¸Šä½¿ç”¨äº†æ•°ç»„, é»˜è®¤åˆå§‹åŒ–å¤§å°æ˜¯ DEFAULT_INITIAL_CAPACITY = 11</p>
<p>ä½¿ç”¨PriorityQueue,ç”¨äºSerializable</p>
<h5 id="DelayQueue"><a href="#DelayQueue" class="headerlink" title="DelayQueue."></a>DelayQueue.</h5><p>å»¶è¿Ÿé˜Ÿåˆ—,å®ç°ä¸Šä½¿ç”¨äº†PriorityQueue,é»˜è®¤åˆå§‹åŒ–å¤§å°æ˜¯ DEFAULT_INITIAL_CAPACITY = 11(æ²¡æœ‰å®ç°java.io.Serializable)</p>
<h4 id="Timing"><a href="#Timing" class="headerlink" title="Timing"></a>Timing</h4><p>â€‹    The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html" target="_blank" rel="noopener"><code>TimeUnit</code></a> class provides multiple granularities (including nanoseconds) for specifying and controlling time-out based operations. Most classes in the package contain operations based on time-outs in addition to indefinite waits. In all cases that time-outs are used, the time-out specifies the minimum time that the method should wait before indicating that it timed-out. Implementations make a â€œbest effortâ€ to detect time-outs as soon as possible after they occur. However, an indefinite amount of time may elapse between a time-out being detected and a thread actually executing again after that time-out. All methods that accept timeout parameters treat values less than or equal to zero to mean not to wait at all. To wait â€œforeverâ€, you can use a value of <code>Long.MAX_VALUE</code>.</p>
<p>TimeUnitç±»æä¾›äº†å¤šä¸ªç²’åº¦(åŒ…æ‹¬çº³ç§’)ï¼Œç”¨äºæŒ‡å®šå’Œæ§åˆ¶åŸºäºè¶…æ—¶çš„æ“ä½œã€‚</p>
<p>åŒ…ä¸­çš„å¤§å¤šæ•°ç±»é™¤äº†ä¸ç¡®å®šçš„ç­‰å¾…ä¹‹å¤–ï¼Œè¿˜åŒ…å«åŸºäºè¶…æ—¶çš„æ“ä½œã€‚åœ¨æ‰€æœ‰ä½¿ç”¨è¶…æ—¶çš„æƒ…å†µä¸‹ï¼Œè¶…æ—¶æŒ‡å®šæ–¹æ³•åœ¨æŒ‡ç¤ºè¶…æ—¶ä¹‹å‰åº”è¯¥ç­‰å¾…çš„æœ€å°æ—¶é—´ã€‚å®ç°ä¼šåœ¨è¶…æ—¶å‘ç”Ÿåâ€œå°½æœ€å¤§åŠªåŠ›â€å°½å¿«æ£€æµ‹è¶…æ—¶ã€‚ç„¶è€Œï¼Œåœ¨æ£€æµ‹åˆ°è¶…æ—¶ä¸å®é™…åœ¨è¶…æ—¶ä¹‹åå†æ¬¡æ‰§è¡Œçš„çº¿ç¨‹ä¹‹é—´å¯èƒ½ä¼šç»è¿‡ä¸€æ®µä¸ç¡®å®šçš„æ—¶é—´ã€‚</p>
<p>æ‰€æœ‰æ¥å—è¶…æ—¶å‚æ•°çš„æ–¹æ³•éƒ½å°†å°äºæˆ–ç­‰äºé›¶çš„å€¼è§†ä¸ºæ ¹æœ¬ä¸ç­‰å¾…ã€‚è¦ç­‰å¾…â€œæ°¸è¿œâ€ï¼Œå¯ä»¥ä½¿ç”¨Long.MAX_VALUEå€¼ã€‚</p>
<pre><code class="java">public enum TimeUnit {
    /**
     * Time unit representing one thousandth of a microsecond
     */
    NANOSECONDS {
        public long toNanos(long d)   { return d; }
        public long toMicros(long d)  { return d/(C1/C0); }
        public long toMillis(long d)  { return d/(C2/C0); }
        public long toSeconds(long d) { return d/(C3/C0); }
        public long toMinutes(long d) { return d/(C4/C0); }
        public long toHours(long d)   { return d/(C5/C0); }
        public long toDays(long d)    { return d/(C6/C0); }
        public long convert(long d, TimeUnit u) { return u.toNanos(d); }
        int excessNanos(long d, long m) { return (int)(d - (m*C2)); }
    },
           MICROSECONDS {
    ...
    },
    ...
            public long convert(long sourceDuration, TimeUnit sourceUnit) {
        throw new AbstractMethodError();
    }
    abstract int excessNanos(long d, long m);

        public void timedWait(Object obj, long timeout)
            throws InterruptedException {
        if (timeout &gt; 0) {
            long ms = toMillis(timeout);
            int ns = excessNanos(timeout, ms);
            obj.wait(ms, ns);
        }
    }
    public void timedJoin(Thread thread, long timeout)
            throws InterruptedException {
        if (timeout &gt; 0) {
            long ms = toMillis(timeout);
            int ns = excessNanos(timeout, ms);
            thread.join(ms, ns);
        }
    }
    public void sleep(long timeout) throws InterruptedException {
        if (timeout &gt; 0) {
            long ms = toMillis(timeout);
            int ns = excessNanos(timeout, ms);
            Thread.sleep(ms, ns);
        }
    }
}
</code></pre>
<h4 id="Synchronizers"><a href="#Synchronizers" class="headerlink" title="Synchronizers"></a>Synchronizers</h4><p><img src="http://ww1.sinaimg.cn/large/006tNc79gy1g62op94yg7j31pe0nqdiy.jpg" alt="image-20190817150022024"></p>
<p>Five classes aid common special-purpose synchronization idioms.</p>
<ul>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Semaphore.html" target="_blank" rel="noopener"><code>Semaphore</code></a> is a classic concurrency tool.</li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CountDownLatch.html" target="_blank" rel="noopener"><code>CountDownLatch</code></a> is a very simple yet very common utility for blocking until a given number of signals, events, or conditions hold.</li>
<li>A <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CyclicBarrier.html" target="_blank" rel="noopener"><code>CyclicBarrier</code></a> is a resettable multiway synchronization point useful in some styles of parallel programming.</li>
<li>A <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Phaser.html" target="_blank" rel="noopener"><code>Phaser</code></a> provides a more flexible form of barrier that may be used to control phased computation among multiple threads.</li>
<li>An <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Exchanger.html" target="_blank" rel="noopener"><code>Exchanger</code></a> allows two threads to exchange objects at a rendezvous point, and is useful in several pipeline designs.</li>
</ul>
<h5 id="Semaphore"><a href="#Semaphore" class="headerlink" title="Semaphore"></a>Semaphore</h5><p>A counting semaphore. Conceptually, a semaphore maintains a set of permits. Each acquire() blocks if necessary until a permit is available, and then takes it. Each release() adds a permit, potentially releasing a blocking acquirer. However, no actual permit objects are used; the Semaphore just keeps a count of the number available and acts accordingly.<br>Semaphores are often used to restrict the number of threads than can access some (physical or logical) resource.</p>
<p>è®¡æ•°ä¿¡å·é‡ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œä¿¡å·é‡ç»´æŠ¤ä¸€ç»„è®¸å¯è¯ã€‚</p>
<p>å¦‚æœæœ‰å¿…è¦ï¼Œæ¯ä¸ªacquire()å—éƒ½ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°è·å¾—è®¸å¯è¯ä¸ºæ­¢ï¼Œç„¶åè·å–è®¸å¯è¯ã€‚</p>
<p>æ¯ä¸ªrelease()éƒ½ä¼šæ·»åŠ ä¸€ä¸ªè®¸å¯è¯ï¼Œæ½œåœ¨åœ°é‡Šæ”¾ä¸€ä¸ªé˜»å¡çš„æ”¶è´­è€…ã€‚</p>
<p>ä½†æ˜¯ï¼Œæ²¡æœ‰ä½¿ç”¨å®é™…çš„è®¸å¯è¯å¯¹è±¡;ä¿¡å·é‡åªä¿ç•™å¯ç”¨æ•°é‡çš„è®¡æ•°ï¼Œå¹¶ç›¸åº”åœ°æ‰§è¡Œæ“ä½œã€‚</p>
<p>ä¿¡å·é‡é€šå¸¸ç”¨äºé™åˆ¶èƒ½å¤Ÿè®¿é—®æŸäº›(ç‰©ç†æˆ–é€»è¾‘)èµ„æºçš„çº¿ç¨‹æ•°ã€‚</p>
<pre><code class="java">public class Semaphore implements java.io.Serializable {
  private final Sync sync;
    /**
     * Synchronization implementation for semaphore.  Uses AQS state
     * to represent permits. Subclassed into fair and nonfair
     * versions.
     */
  abstract static class Sync extends AbstractQueuedSynchronizer {
     ...
     final int nonfairTryAcquireShared(int acquires) {
         for (;;) {
              int available = getState();
              int remaining = available - acquires;
              if (remaining &lt; 0 ||compareAndSetState(available, remaining))
                    return remaining;
         }
      }
  }
      static final class NonfairSync extends Sync {
       ...
           protected int tryAcquireShared(int acquires) {
           return nonfairTryAcquireShared(acquires);
       }
  }
  static final class FairSync extends Sync {
      ...
      protected int tryAcquireShared(int acquires) {
            for (;;) {
                if (hasQueuedPredecessors())
                    return -1;
                int available = getState();
                int remaining = available - acquires;
                if (remaining &lt; 0 ||compareAndSetState(available, remaining))
                    return remaining;
            }
        }
  }
  public Semaphore(int permits) {
       sync = new NonfairSync(permits);
  }
  public Semaphore(int permits, boolean fair) {
       sync = fair ? new FairSync(permits) : new NonfairSync(permits);
  }
  public void acquire(int permits) throws InterruptedException {
        if (permits &lt; 0) throw new IllegalArgumentException();
        sync.acquireSharedInterruptibly(permits);
  }
  public void release(int permits) {
        if (permits &lt; 0) throw new IllegalArgumentException();
        sync.releaseShared(permits);
  }
  ...
}
</code></pre>
<p>åŸºäºAbstractQueuedSynchronizer å®ç°,ä¸»è¦æœ‰acquire å’Œ releaseæ–¹æ³•</p>
<h5 id="CountDownLatch"><a href="#CountDownLatch" class="headerlink" title="CountDownLatch"></a>CountDownLatch</h5><p>A synchronization aid that allows one or more threads to wait until a set of operations being performed in other threads completes.</p>
<p>ä¸€ç§åŒæ­¥è¾…åŠ©ï¼Œå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°åœ¨å…¶ä»–çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä¸€ç»„æ“ä½œå®Œæˆã€‚</p>
<pre><code class="java">public class CountDownLatch {
    /**
     * Synchronization control For CountDownLatch.
     * Uses AQS state to represent count.
     */
    private static final class Sync extends AbstractQueuedSynchronizer {
        private static final long serialVersionUID = 4982264981922014374L;

        Sync(int count) {
            setState(count);
        }

        int getCount() {
            return getState();
        }

        protected int tryAcquireShared(int acquires) {
            return (getState() == 0) ? 1 : -1;
        }

        protected boolean tryReleaseShared(int releases) {
            // Decrement count; signal when transition to zero
            for (;;) {
                int c = getState();
                if (c == 0)
                    return false;
                int nextc = c-1;
                if (compareAndSetState(c, nextc))
                    return nextc == 0;
            }
        }
    }
    private final Sync sync;
    public CountDownLatch(int count) {
        if (count &lt; 0) throw new IllegalArgumentException(&quot;count &lt; 0&quot;);
        this.sync = new Sync(count);
    }
    public void await() throws InterruptedException {
        sync.acquireSharedInterruptibly(1);
    }
    public boolean await(long timeout, TimeUnit unit)
        throws InterruptedException {
        return sync.tryAcquireSharedNanos(1, unit.toNanos(timeout));
    }
    public void countDown() {
        sync.releaseShared(1);
    }
    public long getCount() {
        return sync.getCount();
    }
}
</code></pre>
<h5 id="CyclicBarrier"><a href="#CyclicBarrier" class="headerlink" title="CyclicBarrier"></a>CyclicBarrier</h5><p>ä¸ CountDownLatch ç±»ä¼¼, æœ€å¤§çš„ä¸åŒç‚¹åœ¨äºè°ƒç”¨æ—¶ç‚¹æ˜¯å¦é˜»å¡ ,æ³¨æ„å®ç°ä¹Ÿæ˜¯ä¸åŒçš„</p>
<p>ä»ä½¿ç”¨åœºæ™¯ä¸Šæ¥è¯´ï¼ŒCyclicBarrieræ˜¯è®©å¤šä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…æŸä¸€äº‹ä»¶çš„å‘ç”Ÿï¼Œç„¶ååŒæ—¶è¢«å”¤é†’ã€‚è€Œä¸Šæ–‡è®²çš„CountDownLatchæ˜¯è®©æŸä¸€çº¿ç¨‹ç­‰å¾…å¤šä¸ªçº¿ç¨‹çš„çŠ¶æ€ï¼Œç„¶åè¯¥çº¿ç¨‹è¢«å”¤é†’ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">CountDownLatch</th>
<th>CyclicBarrier</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">å‡è®¡æ•°æ–¹å¼</td>
<td>ReentrantLock</td>
</tr>
<tr>
<td style="text-align:left">è®¡æ•°ä¸º0æ—¶ï¼Œæ— æ³•é‡ç½®</td>
<td>è®¡æ•°ç½®ä¸º0,é‡æ–°å¼€å§‹</td>
</tr>
<tr>
<td style="text-align:left">è°ƒç”¨countDown()æ–¹æ³•è®¡æ•°å‡ä¸€ï¼Œè°ƒç”¨await()æ–¹æ³•åªè¿›è¡Œé˜»å¡ï¼Œå¯¹è®¡æ•°æ²¡ä»»ä½•å½±å“</td>
<td>è°ƒç”¨await()æ–¹æ³•è®¡æ•°countå‡1ï¼Œå‡1åçš„å€¼ä¸ç­‰äºæ„é€ æ–¹æ³•çš„å€¼ï¼Œåˆ™çº¿ç¨‹é˜»å¡,å¦åˆ™æ‰§è¡ŒbarrierCommand</td>
</tr>
</tbody>
</table>
<pre><code class="java">public class CyclicBarrier {
    public CyclicBarrier(int parties, Runnable barrierAction) {
        if (parties &lt;= 0) throw new IllegalArgumentException();
        this.parties = parties;
        this.count = parties;
        this.barrierCommand = barrierAction;
    }
    public CyclicBarrier(int parties) {
        this(parties, null);
    }
    public int await() throws InterruptedException, BrokenBarrierException {
        try {
            return dowait(false, 0L);
        } catch (TimeoutException toe) {
            throw new Error(toe); // cannot happen
        }
    }
    public boolean isBroken() {
        final ReentrantLock lock = this.lock;
        lock.lock();
        try {
            return generation.broken;
        } finally {
            lock.unlock();
        }
    }
    public void reset() {
        final ReentrantLock lock = this.lock;
        lock.lock();
        try {
            breakBarrier();   // break the current generation
            nextGeneration(); // start a new generation
        } finally {
            lock.unlock();
        }
    }
    public int getNumberWaiting() {
        final ReentrantLock lock = this.lock;
        lock.lock();
        try {
            return parties - count;
        } finally {
            lock.unlock();
        }
    }
        ...
}
</code></pre>
<p>â€‹    </p>
<h5 id="Phaser-since-1-7"><a href="#Phaser-since-1-7" class="headerlink" title="Phaser(@since 1.7)"></a>Phaser(@since 1.7)</h5><p>A reusable synchronization barrier, similar in functionality to <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CyclicBarrier.html" target="_blank" rel="noopener"><code>CyclicBarrier</code></a> and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CountDownLatch.html" target="_blank" rel="noopener"><code>CountDownLatch</code></a> but supporting more flexible usage.</p>
<p><strong>Registration</strong> </p>
<p><strong>Synchronization</strong></p>
<p><strong>Termination</strong> </p>
<p><strong>Tiering</strong> (åˆ†å±‚)</p>
<p><strong>Monitoring</strong></p>
<p>CountDownLatchå’ŒCyclicBarrieréƒ½æ˜¯JDK 1.5å¼•å…¥çš„ï¼Œè€ŒPhaseræ˜¯JDK 1.7å¼•å…¥çš„ã€‚Phaserçš„åŠŸèƒ½ä¸CountDownLatchå’ŒCyclicBarrieræœ‰éƒ¨åˆ†é‡å ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†æ›´ä¸°å¯Œçš„è¯­ä¹‰å’Œæ›´çµæ´»çš„ç”¨æ³•ã€‚</p>
<p>Phaseré¡¾åæ€ä¹‰ï¼Œä¸é˜¶æ®µç›¸å…³ã€‚Phaseræ¯”è¾ƒé€‚åˆè¿™æ ·ä¸€ç§åœºæ™¯ï¼Œä¸€ç§ä»»åŠ¡å¯ä»¥åˆ†ä¸ºå¤šä¸ªé˜¶æ®µï¼Œç°å¸Œæœ›å¤šä¸ªçº¿ç¨‹å»å¤„ç†è¯¥æ‰¹ä»»åŠ¡ï¼Œå¯¹äºæ¯ä¸ªé˜¶æ®µï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å¹¶å‘è¿›è¡Œï¼Œä½†æ˜¯å¸Œæœ›ä¿è¯åªæœ‰å‰é¢ä¸€ä¸ªé˜¶æ®µçš„ä»»åŠ¡å®Œæˆä¹‹åæ‰èƒ½å¼€å§‹åé¢çš„ä»»åŠ¡ã€‚</p>
<p>è¿™ç§åœºæ™¯å¯ä»¥ä½¿ç”¨å¤šä¸ªCyclicBarrieræ¥å®ç°ï¼Œæ¯ä¸ªCyclicBarrierè´Ÿè´£ç­‰å¾…ä¸€ä¸ªé˜¶æ®µçš„ä»»åŠ¡å…¨éƒ¨å®Œæˆã€‚ä½†æ˜¯ä½¿ç”¨CyclicBarrierçš„ç¼ºç‚¹åœ¨äºï¼Œéœ€è¦æ˜ç¡®çŸ¥é“æ€»å…±æœ‰å¤šå°‘ä¸ªé˜¶æ®µï¼ŒåŒæ—¶å¹¶è¡Œçš„ä»»åŠ¡æ•°éœ€è¦æå‰é¢„å®šä¹‰å¥½ï¼Œä¸”æ— æ³•åŠ¨æ€ä¿®æ”¹ã€‚è€ŒPhaserå¯åŒæ—¶è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p>
<blockquote>
<p>@see <a href="http://www.jasongj.com/java/thread_communication/" target="_blank" rel="noopener">http://www.jasongj.com/java/thread_communication/</a></p>
</blockquote>
<h5 id="Exchanger"><a href="#Exchanger" class="headerlink" title="Exchanger"></a>Exchanger</h5><p>A ==synchronization== point at which threads can pair and swap elements within pairs. </p>
<p>Each thread presents some object on entry to the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Exchanger.html#exchange-V-" target="_blank" rel="noopener"><code>exchange</code></a> method, matches with a partner thread, and receives its partnerâ€™s object on return. </p>
<p>An Exchanger may be viewed as a bidirectional form of a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/SynchronousQueue.html" target="_blank" rel="noopener"><code>SynchronousQueue</code></a>. </p>
<p>Exchangers may be useful in applications such as genetic algorithms and pipeline designs.</p>
<p>åœ¨ä»¥ä¸Šçš„æè¿°ä¸­ï¼Œæœ‰å‡ ä¸ªè¦ç‚¹ï¼š</p>
<ul>
<li>æ­¤ç±»æä¾›å¯¹å¤–çš„æ“ä½œæ˜¯åŒæ­¥çš„ï¼›</li>
<li>ç”¨äºæˆå¯¹å‡ºç°çš„çº¿ç¨‹ä¹‹é—´äº¤æ¢æ•°æ®ï¼›</li>
<li>å¯ä»¥è§†ä½œåŒå‘çš„åŒæ­¥é˜Ÿåˆ—ï¼›</li>
<li>å¯åº”ç”¨äºåŸºå› ç®—æ³•ã€æµæ°´çº¿è®¾è®¡ç­‰åœºæ™¯ã€‚</li>
</ul>
<pre><code class="java">public class Exchanger&lt;V&gt; {
    @sun.misc.Contended static final class Node {
        int index;              // Arena index
        int bound;              // Last recorded value of Exchanger.bound
        int collides;           // Number of CAS failures at current bound
        int hash;               // Pseudo-random for spins
        Object item;            // This thread&#39;s current item
        volatile Object match;  // Item provided by releasing thread
        volatile Thread parked; // Set to this thread when parked, else null
    }
    static final class Participant extends ThreadLocal&lt;Node&gt; {
        public Node initialValue() { return new Node(); }
    }
    public Exchanger() {
        participant = new Participant();
    }
    public V exchange(V x) throws InterruptedException {
        Object v;
        Object item = (x == null) ? NULL_ITEM : x; // translate null args
        if ((arena != null ||
             (v = slotExchange(item, false, 0L)) == null) &amp;&amp;
            ((Thread.interrupted() || // disambiguates null return
              (v = arenaExchange(item, false, 0L)) == null)))
            throw new InterruptedException();
        return (v == NULL_ITEM) ? null : (V)v;
    }
    public V exchange(V x, long timeout, TimeUnit unit)
        throws InterruptedException, TimeoutException {
        Object v;
        Object item = (x == null) ? NULL_ITEM : x;
        long ns = unit.toNanos(timeout);
        if ((arena != null ||
             (v = slotExchange(item, true, ns)) == null) &amp;&amp;
            ((Thread.interrupted() ||
              (v = arenaExchange(item, true, ns)) == null)))
            throw new InterruptedException();
        if (v == TIMED_OUT)
            throw new TimeoutException();
        return (v == NULL_ITEM) ? null : (V)v;
    }
}
</code></pre>
<p>æœ‰ç‚¹ç±»ä¼¼äºç”Ÿäº§è€…/æ¶ˆè´¹è€… </p>
<blockquote>
<p>@see <a href="https://blog.csdn.net/coslay/article/details/45242581" target="_blank" rel="noopener">https://blog.csdn.net/coslay/article/details/45242581</a></p>
</blockquote>
<h4 id="Concurrent-Collections"><a href="#Concurrent-Collections" class="headerlink" title="Concurrent Collections"></a>Concurrent Collections</h4><p>ç”¨äºå¹¶å‘è®¿é—®çš„é›†åˆ(Listã€Mapã€Set)</p>
<p>Besides Queues, this package supplies Collection implementations designed for use in multithreaded contexts: <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentHashMap.html" target="_blank" rel="noopener"><code>ConcurrentHashMap</code></a><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentSkipListMap.html" target="_blank" rel="noopener"><code>ConcurrentSkipListMap</code></a><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentSkipListSet.html" target="_blank" rel="noopener"><code>ConcurrentSkipListSet</code></a><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CopyOnWriteArrayList.html" target="_blank" rel="noopener"><code>CopyOnWriteArrayList</code></a><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CopyOnWriteArraySet.html" target="_blank" rel="noopener"><code>CopyOnWriteArraySet</code></a>    </p>
<p>When many threads are expected to access a given collection, a <code>ConcurrentHashMap</code> is normally preferable to a synchronized <code>HashMap</code>, and a <code>ConcurrentSkipListMap</code> is normally preferable to a synchronized <code>TreeMap</code>. A <code>CopyOnWriteArrayList</code> is preferable to a synchronized <code>ArrayList</code>when the expected number of reads and traversals greatly outnumber the number of updates to a list.</p>
<p>ä¸synchronizedå°è£…çš„ç±»ä¸åŒ, Concurrentå¼€å¤´çš„æ”¯æŒå¹¶å‘è®¿é—®</p>
<p>The â€œConcurrentâ€ prefix used with some classes in this package is a shorthand indicating several differences from similar â€œsynchronizedâ€ classes. </p>
<p>For example <code>java.util.Hashtable</code> and <code>Collections.synchronizedMap(new HashMap())</code> are synchronized. But <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentHashMap.html" target="_blank" rel="noopener"><code>ConcurrentHashMap</code></a> is â€œconcurrentâ€. A concurrent collection is thread-safe, but not governed by a single exclusion lock. In the particular case of ConcurrentHashMap, it safely permits any number of concurrent reads as well as a tunable number of concurrent writes. </p>
<p>â€œSynchronizedâ€ classes can be useful when you need to prevent all access to a collection via a single lock, at the expense of poorer scalability. In other cases in which multiple threads are expected to access a common collection, â€œconcurrentâ€ versions are normally preferable. And unsynchronized collections are preferable when either collections are unshared, or are accessible only when holding other locks.</p>
<p>æä¾›å¼±ä¸€è‡´çš„éå†,è€Œä¸æ˜¯å¿«é€Ÿå¤±è´¥</p>
<p>Most concurrent Collection implementations (including most Queues) also differ from the usual <code>java.util</code> conventions in that their <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Iterator.html" target="_blank" rel="noopener">Iterators</a> and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Spliterator.html" target="_blank" rel="noopener">Spliterators</a> provide <em>weakly consistent</em> rather than fast-fail traversal:</p>
<ul>
<li>they may proceed concurrently with other operations</li>
<li>they will never throw <a href="https://docs.oracle.com/javase/8/docs/api/java/util/ConcurrentModificationException.html" target="_blank" rel="noopener"><code>ConcurrentModificationException</code></a></li>
<li>they are guaranteed to traverse elements as they existed upon construction exactly once, and may (but are not guaranteed to) reflect any modifications subsequent to construction.</li>
</ul>
<h5 id="ConcurrentHashMap"><a href="#ConcurrentHashMap" class="headerlink" title="ConcurrentHashMap"></a>ConcurrentHashMap</h5><h5 id="ConcurrentSkipListMap"><a href="#ConcurrentSkipListMap" class="headerlink" title="ConcurrentSkipListMap"></a>ConcurrentSkipListMap</h5><h5 id="ConcurrentSkipListSet"><a href="#ConcurrentSkipListSet" class="headerlink" title="ConcurrentSkipListSet"></a>ConcurrentSkipListSet</h5><h5 id="CopyOnWriteArrayList"><a href="#CopyOnWriteArrayList" class="headerlink" title="CopyOnWriteArrayList"></a>CopyOnWriteArrayList</h5><h5 id="CopyOnWriteArraySet"><a href="#CopyOnWriteArraySet" class="headerlink" title="CopyOnWriteArraySet"></a>CopyOnWriteArraySet</h5><h4 id="Memory-Consistency-Properties-å†…å­˜ä¸€è‡´æ€§"><a href="#Memory-Consistency-Properties-å†…å­˜ä¸€è‡´æ€§" class="headerlink" title="Memory Consistency Properties (å†…å­˜ä¸€è‡´æ€§)"></a>Memory Consistency Properties (å†…å­˜ä¸€è‡´æ€§)</h4><p>Javaè¯­è¨€è§„èŒƒç¬¬17ç« å®šä¹‰äº†å†…å­˜æ“ä½œä¸Šçš„<em>happens-before</em>å…³ç³»ï¼Œæ¯”å¦‚å…±äº«å˜é‡çš„è¯»å†™ã€‚åªæœ‰å½“å†™æ“ä½œå‘ç”Ÿæ—¶(åœ¨è¯»æ“ä½œä¹‹å‰)ï¼Œä¸€ä¸ªçº¿ç¨‹çš„å†™æ“ä½œçš„ç»“æœæ‰ä¿è¯å¯¹å¦ä¸€ä¸ªçº¿ç¨‹çš„è¯»æ“ä½œå¯è§ã€‚åŒæ­¥å’Œvolatileæ„é€ ï¼Œä»¥åŠThread.start()å’ŒThread.join()æ–¹æ³•ï¼Œå¯ä»¥å½¢æˆhappens-beforeå…³ç³»ã€‚</p>
<p><a href="https://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.5" target="_blank" rel="noopener">Chapter 17 of the Java Language Specification</a> defines the <em>happens-before</em> relation on memory operations such as reads and writes of shared variables. The results of a write by one thread are guaranteed to be visible to a read by another thread only if the write operation <em>happens-before</em>  the read operation. The synchronized  and volatile constructs, as well as the Thread.start() and Thread.join() methods, can form <em>happens-before</em>  relationships. In particular:</p>
<ul>
<li>Each action in a thread <em>happens-before</em> every action in that thread that comes later in the programâ€™s order.</li>
<li>An unlock (<code>synchronized</code> block or method exit) of a monitor <em>happens-before</em> every subsequent lock (<code>synchronized</code> block or method entry) of that same monitor. And because the <em>happens-before</em> relation is transitive, all actions of a thread prior to unlocking <em>happen-before</em> all actions subsequent to any thread locking that monitor.</li>
<li>A write to a <code>volatile</code> field <em>happens-before</em> every subsequent read of that same field. Writes and reads of <code>volatile</code> fields have similar memory consistency effects as entering and exiting monitors, but do <em>not</em> entail mutual exclusion locking.</li>
<li>A call to <code>start</code> on a thread <em>happens-before</em> any action in the started thread.</li>
<li>All actions in a thread <em>happen-before</em> any other thread successfully returns from a <code>join</code> on that thread.</li>
</ul>
<p>åœ¨jucä¸­,æ‰€æœ‰classesçš„ <em>happens-before</em> å…³ç³»</p>
<p>The methods of all classes in <code>java.util.concurrent</code></p>
<ul>
<li>Actions in a thread prior to placing an object into any concurrent collection <em>happen-before</em> actions subsequent to the access or removal of that element from the collection in another thread.</li>
<li>Actions in a thread prior to the submission of a <code>Runnable</code> to an <code>Executor</code> <em>happen-before</em> its execution begins. Similarly for <code>Callables</code> submitted to an <code>ExecutorService</code>.</li>
<li>Actions taken by the asynchronous computation represented by a <code>Future</code> <em>happen-before</em> actions subsequent to the retrieval of the result via <code>Future.get()</code> in another thread.</li>
<li>Actions prior to â€œreleasingâ€ synchronizer methods such as <code>Lock.unlock</code>, <code>Semaphore.release</code>, and <code>CountDownLatch.countDown</code> <em>happen-before</em> actions subsequent to a successful â€œacquiringâ€ method such as <code>Lock.lock</code>, <code>Semaphore.acquire</code>,<code>Condition.await</code>, and <code>CountDownLatch.await</code> on the same synchronizer object in another thread.</li>
<li>For each pair of threads that successfully exchange objects via an <code>Exchanger</code>, actions prior to the <code>exchange()</code> in each thread <em>happen-before</em> those subsequent to the corresponding <code>exchange()</code> in another thread.</li>
<li>Actions prior to calling <code>CyclicBarrier.await</code> and <code>Phaser.awaitAdvance</code> (as well as its variants) <em>happen-before</em> actions performed by the barrier action, and actions performed by the barrier action <em>happen-before</em> actions subsequent to a successful return from the corresponding <code>await</code> in other threads.</li>
</ul>
<h3 id="java-util-concurrent-atomic"><a href="#java-util-concurrent-atomic" class="headerlink" title="java.util.concurrent.atomic"></a>java.util.concurrent.atomic</h3><p>â€‹    </p>
<p>ä¸€ä¸ªæ”¯æŒå•å˜é‡æ— é”çº¿ç¨‹å®‰å…¨ç¼–ç¨‹çš„ç±»çš„å°å·¥å…·åŒ…ã€‚æœ¬è´¨ä¸Šï¼Œè¿™ä¸ªåŒ…ä¸­çš„ç±»å°†volatileå€¼ã€å­—æ®µå’Œæ•°ç»„å…ƒç´ çš„æ¦‚å¿µæ‰©å±•åˆ°é‚£äº›è¿˜æä¾› <em>compareAndSet</em> çš„åŸå­æ¡ä»¶æ›´æ–°æ“ä½œçš„ç±»</p>
<p>A small toolkit of classes that support lock-free thread-safe programming on single variables.</p>
<p>In essence, the classes in this package extend the notion of <code>volatile</code>  values, fields, and array elements to those that also provide an atomic conditional update operation of the form:</p>
<pre><code> boolean compareAndSet(expectedValue, updateValue);
</code></pre><p>This method (which varies in argument types across different classes) atomically sets a variable to the <code>updateValue</code> if it currently holds the <code>expectedValue</code>, reporting <code>true</code> on success. </p>
<p>The classes in this package also contain methods to get and unconditionally set values, as well as a weaker conditional atomic update operation <code>weakCompareAndSet</code> described below.</p>
<p>The memory effects for accesses and updates of atomics generally follow the rules for volatiles, as stated in <a href="https://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4" target="_blank" rel="noopener">The Java Language Specification (17.4 Memory Model)</a>:</p>
<ul>
<li><code>get</code> has the memory effects of reading a <code>volatile</code> variable.</li>
<li><code>set</code> has the memory effects of writing (assigning) a <code>volatile</code> variable.</li>
<li><code>lazySet</code> has the memory effects of writing (assigning) a <code>volatile</code> variable except that it permits reorderings with subsequent (but not previous) memory actions that do not themselves impose reordering constraints with ordinary non-<code>volatile</code> writes. Among other usage contexts, <code>lazySet</code> may apply when nulling out, for the sake of garbage collection, a reference that is never accessed again.</li>
<li><code>weakCompareAndSet</code> atomically reads and conditionally writes a variable but does <em>not</em> create any happens-before orderings, so provides no guarantees with respect to previous or subsequent reads and writes of any variables other than the target of the <code>weakCompareAndSet</code>.</li>
<li><code>compareAndSet</code> and all other read-and-update operations such as <code>getAndIncrement</code> have the memory effects of both reading and writing <code>volatile</code> variables.</li>
</ul>
<h4 id="Atomic-Values"><a href="#Atomic-Values" class="headerlink" title="Atomic Values"></a>Atomic Values</h4><p>Instances of classes <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicBoolean.html" target="_blank" rel="noopener"><code>AtomicBoolean</code></a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicInteger.html" target="_blank" rel="noopener"><code>AtomicInteger</code></a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicLong.html" target="_blank" rel="noopener"><code>AtomicLong</code></a>, and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicReference.html" target="_blank" rel="noopener"><code>AtomicReference</code></a> each provide access and updates to a single variable of the corresponding type. Each class also provides appropriate utility methods for that type. For example, classes <code>AtomicLong</code> and <code>AtomicInteger</code> provide atomic increment methods. </p>
<pre><code class="java">public class AtomicInteger extends Number implements java.io.Serializable {
    private volatile int value;

    /**
     * Creates a new AtomicInteger with the given initial value.
     *
     * @param initialValue the initial value
     */
    public AtomicInteger(int initialValue) {
        value = initialValue;
    }

    /**
     * Creates a new AtomicInteger with initial value {@code 0}.
     */
    public AtomicInteger() {
    }
}
</code></pre>
<h4 id="Atomic-Fields"><a href="#Atomic-Fields" class="headerlink" title="Atomic Fields"></a>Atomic Fields</h4><p>In addition to classes representing single values, this package contains <em>Updater</em> classes that can be used to obtain <code>compareAndSet</code> operations on any selected <code>volatile</code> field of any selected class. <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicReferenceFieldUpdater.html" target="_blank" rel="noopener"><code>AtomicReferenceFieldUpdater</code></a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicIntegerFieldUpdater.html" target="_blank" rel="noopener"><code>AtomicIntegerFieldUpdater</code></a>, and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicLongFieldUpdater.html" target="_blank" rel="noopener"><code>AtomicLongFieldUpdater</code></a> are reflection-based utilities that provide access to the associated field types. These are mainly of use in atomic data structures in which several <code>volatile</code> fields of the same node (for example, the links of a tree node) are independently subject to atomic updates. These classes enable greater flexibility in how and when to use atomic updates, at the expense of more awkward reflection-based setup, less convenient usage, and weaker guarantees.</p>
<h4 id="Atomic-Arrays"><a href="#Atomic-Arrays" class="headerlink" title="Atomic Arrays"></a>Atomic Arrays</h4><p>The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicIntegerArray.html" target="_blank" rel="noopener"><code>AtomicIntegerArray</code></a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicLongArray.html" target="_blank" rel="noopener"><code>AtomicLongArray</code></a>, and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicReferenceArray.html" target="_blank" rel="noopener"><code>AtomicReferenceArray</code></a> classes further extend atomic operation support to arrays of these types. These classes are also notable in providing <code>volatile</code> access semantics for their array elements, which is not supported for ordinary arrays.</p>
<h4 id="Class-Summary"><a href="#Class-Summary" class="headerlink" title="Class Summary"></a>Class Summary</h4><table>
<thead>
<tr>
<th style="text-align:left">Class</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicBoolean.html" target="_blank" rel="noopener">AtomicBoolean</a></td>
<td style="text-align:left">A <code>boolean</code> value that may be updated atomically.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicInteger.html" target="_blank" rel="noopener">AtomicInteger</a></td>
<td style="text-align:left">An <code>int</code> value that may be updated atomically.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicIntegerArray.html" target="_blank" rel="noopener">AtomicIntegerArray</a></td>
<td style="text-align:left">An <code>int</code> array in which elements may be updated atomically.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicIntegerFieldUpdater.html" target="_blank" rel="noopener">AtomicIntegerFieldUpdater</a><t></t></td>
<td style="text-align:left">A reflection-based utility that enables atomic updates to designated <code>volatile int</code> fields of designated classes.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicLong.html" target="_blank" rel="noopener">AtomicLong</a></td>
<td style="text-align:left">A <code>long</code> value that may be updated atomically.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicLongArray.html" target="_blank" rel="noopener">AtomicLongArray</a></td>
<td style="text-align:left">A <code>long</code> array in which elements may be updated atomically.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicLongFieldUpdater.html" target="_blank" rel="noopener">AtomicLongFieldUpdater</a><t></t></td>
<td style="text-align:left">A reflection-based utility that enables atomic updates to designated <code>volatile long</code> fields of designated classes.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicMarkableReference.html" target="_blank" rel="noopener">AtomicMarkableReference</a><v></v></td>
<td style="text-align:left">An <code>AtomicMarkableReference</code> maintains an object reference along with a mark bit, that can be updated atomically.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicReference.html" target="_blank" rel="noopener">AtomicReference</a><v></v></td>
<td style="text-align:left">An object reference that may be updated atomically.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicReferenceArray.html" target="_blank" rel="noopener">AtomicReferenceArray</a><e></e></td>
<td style="text-align:left">An array of object references in which elements may be updated atomically.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicReferenceFieldUpdater.html" target="_blank" rel="noopener">AtomicReferenceFieldUpdater</a>&lt;T,V&gt;</td>
<td style="text-align:left">A reflection-based utility that enables atomic updates to designated <code>volatile</code> reference fields of designated classes.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicStampedReference.html" target="_blank" rel="noopener">AtomicStampedReference</a><v></v></td>
<td style="text-align:left">An <code>AtomicStampedReference</code> maintains an object reference along with an integer â€œstampâ€, that can be updated atomically.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/DoubleAccumulator.html" target="_blank" rel="noopener">DoubleAccumulator</a></td>
<td style="text-align:left">One or more variables that together maintain a running <code>double</code> value updated using a supplied function.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/DoubleAdder.html" target="_blank" rel="noopener">DoubleAdder</a></td>
<td style="text-align:left">One or more variables that together maintain an initially zero <code>double</code> sum.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/LongAccumulator.html" target="_blank" rel="noopener">LongAccumulator</a></td>
<td style="text-align:left">One or more variables that together maintain a running <code>long</code> value updated using a supplied function.</td>
</tr>
<tr>
<td style="text-align:left"><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/LongAdder.html" target="_blank" rel="noopener">LongAdder</a></td>
<td style="text-align:left">One or more variables that together maintain an initially zero <code>long</code> sum.</td>
</tr>
</tbody>
</table>
<h4 id="Designed"><a href="#Designed" class="headerlink" title="Designed"></a>Designed</h4><p>åŸå­ç±»ä¸»è¦è®¾è®¡ä¸ºç”¨äºå®ç°éé˜»å¡æ•°æ®ç»“æ„å’Œç›¸å…³åŸºç¡€ç»“æ„ç±»çš„æ„å»ºå—ã€‚è¯¥<code>compareAndSet</code>æ–¹æ³•ä¸æ˜¯é”å®šçš„ä¸€èˆ¬æ›¿ä»£æ–¹æ³•ã€‚ä»…å½“å¯¹è±¡çš„å…³é”®æ›´æ–°ä»…é™äº<em>å•ä¸ª</em>å˜é‡æ—¶ï¼Œå®ƒæ‰é€‚ç”¨ã€‚</p>
<p>åŸå­ç±»ä¸æ˜¯é€šç”¨æ›¿æ¢ <code>java.lang.Integer</code>å’Œç›¸å…³ç±»ã€‚ä»–ä»¬<em>æ²¡æœ‰</em> å®šä¹‰æ–¹æ³•ï¼Œå¦‚<code>equals</code>ï¼Œ<code>hashCode</code>å’Œ <code>compareTo</code>ã€‚ï¼ˆå› ä¸ºé¢„æœŸåŸå­å˜é‡ä¼šå‘ç”Ÿå˜å¼‚ï¼Œæ‰€ä»¥å®ƒä»¬å¯¹äºæ•£åˆ—è¡¨é”®çš„é€‰æ‹©å¾ˆå·®ã€‚ï¼‰æ­¤å¤–ï¼Œåªä¸ºé‚£äº›åœ¨é¢„æœŸåº”ç”¨ç¨‹åºä¸­å¸¸ç”¨çš„ç±»å‹æä¾›ç±»ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰ç”¨äºè¡¨ç¤ºçš„åŸå­ç±»<code>byte</code>ã€‚åœ¨æ‚¨æƒ³è¦è¿™æ ·åšçš„ä¸å¸¸è§çš„æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨a <code>AtomicInteger</code>æ¥ä¿å­˜ <code>byte</code>å€¼ï¼Œå¹¶é€‚å½“åœ°è¿›è¡ŒæŠ•å°„ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Float.html#floatToRawIntBits-float-" target="_blank" rel="noopener"><code>Float.floatToRawIntBits(float)</code></a>å’Œ <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Float.html#intBitsToFloat-int-" target="_blank" rel="noopener"><code>Float.intBitsToFloat(int)</code></a>è½¬æ¢ä½¿ç”¨æµ®ç‚¹æ•° ï¼Œå¹¶ä½¿ç”¨<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Double.html#doubleToRawLongBits-double-" target="_blank" rel="noopener"><code>Double.doubleToRawLongBits(double)</code></a>å’Œ <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Double.html#longBitsToDouble-long-" target="_blank" rel="noopener"><code>Double.longBitsToDouble(long)</code></a>è½¬æ¢åŠ å€ã€‚</p>
<p>åŸæ–‡  : </p>
<blockquote>
<p>Atomic classes are designed primarily as building blocks for implementing non-blocking data structures and related infrastructure classes. The <code>compareAndSet</code> method is not a general replacement for locking. It applies only when critical updates for an object are confined to a <em>single</em> variable.</p>
<p>Atomic classes are not general purpose replacements for <code>java.lang.Integer</code> and related classes. They do <em>not</em> define methods such as <code>equals</code>, <code>hashCode</code> and <code>compareTo</code>. (Because atomic variables are expected to be mutated, they are poor choices for hash table keys.) Additionally, classes are provided only for those types that are commonly useful in intended applications. For example, there is no atomic class for representing <code>byte</code>. In those infrequent cases where you would like to do so, you can use an <code>AtomicInteger</code>to hold <code>byte</code> values, and cast appropriately. You can also hold floats using <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Float.html#floatToRawIntBits-float-" target="_blank" rel="noopener"><code>Float.floatToRawIntBits(float)</code></a> and <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Float.html#intBitsToFloat-int-" target="_blank" rel="noopener"><code>Float.intBitsToFloat(int)</code></a> conversions, and doubles using <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Double.html#doubleToRawLongBits-double-" target="_blank" rel="noopener"><code>Double.doubleToRawLongBits(double)</code></a> and <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Double.html#longBitsToDouble-long-" target="_blank" rel="noopener"><code>Double.longBitsToDouble(long)</code></a>conversions.</p>
</blockquote>
<p><strong><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/package-summary.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/package-summary.html</a></strong></p>
<h3 id="java-util-concurrent-locks"><a href="#java-util-concurrent-locks" class="headerlink" title="java.util.concurrent.locks"></a>java.util.concurrent.locks</h3><p><img src="http://ww3.sinaimg.cn/large/006tNc79gy1g62ox5893vj32f50u0q7l.jpg" alt="image-20190817150757762"></p>
<p>æ³¨æ„ConditionObject (ä¸çŸ¥é“ä¸ºå•¥æ²¡æœ‰æ˜¾ç¤ºä¸ºAbstractQueuedSynchronizer inner class)</p>
<p>æ¥å£å’Œç±»æä¾›äº†ä¸€ä¸ªæ¡†æ¶ï¼Œç”¨äºé”å®šå’Œç­‰å¾…,ä¸å†…ç½®åŒæ­¥å’Œç›‘è§†å™¨ä¸åŒçš„æ¡ä»¶ã€‚è¯¥æ¡†æ¶å…è®¸åœ¨ä½¿ç”¨é”å’Œæ¡ä»¶æ–¹é¢å…·æœ‰æ›´å¤§çš„çµæ´»æ€§ï¼Œä½†ä»£ä»·æ˜¯è¯­æ³•æ›´åŠ ç¬¨æ‹™ã€‚</p>
<p>Interfaces and classes providing a framework for locking and waiting for conditions that is distinct from built-in synchronization and monitors. The framework permits much greater flexibility in the use of locks and conditions, at the expense of more awkward syntax.</p>
<h4 id="Locks-é”"><a href="#Locks-é”" class="headerlink" title="Locks(é”)"></a>Locks(é”)</h4><p>The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/Lock.html" target="_blank" rel="noopener"><code>Lock</code></a> interface supports locking disciplines that differ in semantics (reentrant, fair, etc), and that can be used in non-block-structured contexts including hand-over-hand and lock reordering algorithms. The main implementation is <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReentrantLock.html" target="_blank" rel="noopener"><code>ReentrantLock</code></a>.</p>
<p>The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReadWriteLock.html" target="_blank" rel="noopener"><code>ReadWriteLock</code></a> interface similarly defines locks that may be shared among readers but are exclusive to writers. Only a single implementation, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html" target="_blank" rel="noopener"><code>ReentrantReadWriteLock</code></a>, is provided, since it covers most standard usage contexts. But programmers may create their own implementations to cover nonstandard requirements.</p>
<p>Lockæ¥å£æ”¯æŒè¯­ä¹‰ä¸åŒçš„é”å®šè§„åˆ™(å¯é‡å…¥ã€å…¬å¹³ç­‰)ï¼Œå¹¶ä¸”å¯ä»¥åœ¨éå—ç»“æ„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ï¼ŒåŒ…æ‹¬æ‰‹åŠ¨å’Œé”é‡æ’åºç®—æ³•ã€‚ä¸»è¦å®ç°æ˜¯ReentrantLockã€‚</p>
<p>ReadWriteLockæ¥å£ä¹Ÿç±»ä¼¼åœ°å®šä¹‰äº†é”ï¼Œè¿™äº›é”å¯ä»¥åœ¨readersä¹‹é—´å…±äº«ï¼Œä½†åªèƒ½ç”±writersä½¿ç”¨ã€‚åªæä¾›äº†ä¸€ä¸ªå®ç°ReentrantReadWriteLockï¼Œå› ä¸ºå®ƒæ¶µç›–äº†å¤§å¤šæ•°æ ‡å‡†ä½¿ç”¨ä¸Šä¸‹æ–‡ã€‚ä½†æ˜¯ç¨‹åºå‘˜å¯ä»¥åˆ›å»ºä»–ä»¬è‡ªå·±çš„å®ç°æ¥æ»¡è¶³éæ ‡å‡†éœ€æ±‚ã€‚</p>
<h5 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h5><h6 id="Lockä¸synchronizedçš„å¼‚åŒ"><a href="#Lockä¸synchronizedçš„å¼‚åŒ" class="headerlink" title="Lockä¸synchronizedçš„å¼‚åŒ"></a>Lockä¸synchronizedçš„å¼‚åŒ</h6><ul>
<li>å†…å­˜è¯­ä¹‰ç›¸åŒ</li>
</ul>
<p><em>Memory Synchronization</em></p>
<p>All <code>Lock</code> implementations <em>must</em> enforce the same memory synchronization semantics as provided by the built-in monitor lock, as described in <a href="https://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4" target="_blank" rel="noopener">The Java Language Specification (17.4 Memory Model)</a>:</p>
<ul>
<li>A successful <code>lock</code> operation has the same memory synchronization effects as a successful <em>Lock</em> action.</li>
<li>A successful <code>unlock</code> operation has the same memory synchronization effects as a successful <em>Unlock</em> action.</li>
</ul>
<p>Unsuccessful locking and unlocking operations, and reentrant locking/unlocking operations, do not require any memory synchronization effects.</p>
<ul>
<li><p>synchronizationæ˜¯å…³é”®å­—(å¯é‡å…¥,éå…¬å¹³é”,é”çš„æ˜¯å¯¹è±¡Object), Lockæ˜¯æ¥å£</p>
</li>
<li><p>synchronization ä½¿ç”¨ç®€å•,æ— éœ€æ‰‹åŠ¨é‡Šæ”¾é”,é¿å…é”™è¯¯</p>
<p>  When locking and unlocking occur in different scopes, care must be taken to ensure that all code that is executed while the lock is held is protected by try-finally or try-catch to ensure that the lock is released when necessary.</p>
</li>
<li><p>Lock æ›´åŠ çµæ´»,  æ”¯æŒéé˜»å¡è·å– ,å¯ä¸­æ–­è·å–,å’Œå¯è¶…æ—¶è·å–.</p>
<p>  <code>Lock</code> implementations provide additional functionality over the use of <code>synchronized</code> methods and statements by providing a non-blocking attempt to acquire a lock (<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/Lock.html#tryLock--" target="_blank" rel="noopener"><code>tryLock()</code></a>), an attempt to acquire the lock that can be interrupted (<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/Lock.html#lockInterruptibly--" target="_blank" rel="noopener"><code>lockInterruptibly()</code></a>, and an attempt to acquire the lock that can timeout (<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/Lock.html#tryLock-long-java.util.concurrent.TimeUnit-" target="_blank" rel="noopener"><code>tryLock(long, TimeUnit)</code></a>).</p>
</li>
</ul>
<h6 id="Implementation-Considerations"><a href="#Implementation-Considerations" class="headerlink" title="Implementation Considerations"></a>Implementation Considerations</h6><p>ä¸‰ç§å½¢å¼çš„é”è·å–(å¯ä¸­æ–­ã€ä¸å¯ä¸­æ–­å’Œå®šæ—¶)åœ¨æ€§èƒ½ç‰¹å¾ã€é¡ºåºä¿è¯æˆ–å…¶ä»–å®ç°è´¨é‡æ–¹é¢å¯èƒ½æœ‰æ‰€ä¸åŒã€‚</p>
<p>æ­¤å¤–ï¼Œä¸­æ–­æ­£åœ¨è¿›è¡Œçš„é”è·å–çš„åŠŸèƒ½å¯èƒ½åœ¨ç»™å®šçš„é”ç±»ä¸­ä¸å¯ç”¨ã€‚å› æ­¤ï¼Œå®ç°ä¸éœ€è¦ä¸ºæ‰€æœ‰ä¸‰ç§å½¢å¼çš„é”è·å–å®šä¹‰å®Œå…¨ç›¸åŒçš„ä¿è¯æˆ–è¯­ä¹‰ï¼Œä¹Ÿä¸éœ€è¦æ”¯æŒä¸­æ–­æ­£åœ¨è¿›è¡Œçš„é”è·å–ã€‚</p>
<p>éœ€è¦ä¸€ä¸ªå®ç°æ¥æ¸…æ¥šåœ°è®°å½•æ¯ç§é”å®šæ–¹æ³•æä¾›çš„è¯­ä¹‰å’Œä¿è¯ã€‚å®ƒè¿˜å¿…é¡»éµå®ˆè¿™ä¸ªæ¥å£ä¸­å®šä¹‰çš„ä¸­æ–­è¯­ä¹‰ï¼Œåªè¦æ”¯æŒé”è·å–ä¸­æ–­:è¦ä¹ˆå®Œå…¨æ”¯æŒï¼Œè¦ä¹ˆåªæ”¯æŒæ–¹æ³•å…¥å£ã€‚</p>
<p>ç”±äºä¸­æ–­é€šå¸¸æ„å‘³ç€å–æ¶ˆï¼Œå¹¶ä¸”å¯¹ä¸­æ–­çš„æ£€æŸ¥é€šå¸¸ä¸é¢‘ç¹ï¼Œå› æ­¤å®ç°æ›´å€¾å‘äºå“åº”ä¸­æ–­è€Œä¸æ˜¯æ­£å¸¸çš„æ–¹æ³•è¿”å›ã€‚å³ä½¿å¯ä»¥æ˜¾ç¤ºåœ¨å¦ä¸€ä¸ªæ“ä½œä¹‹åå‘ç”Ÿçš„ä¸­æ–­å¯èƒ½å·²ç»è§£é™¤äº†çº¿ç¨‹é˜»å¡ï¼Œè¿™ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚å®ç°åº”è¯¥è®°å½•è¿™ç§è¡Œä¸ºã€‚</p>
<blockquote>
<p>The three forms of lock acquisition (interruptible, non-interruptible, and timed) may differ in their performance characteristics, ordering guarantees, or other implementation qualities. </p>
<p>Further, the ability to interrupt the <em>ongoing</em> acquisition of a lock may not be available in a given <code>Lock</code> class. Consequently, an implementation is not required to define exactly the same guarantees or semantics for all three forms of lock acquisition, nor is it required to support interruption of an ongoing lock acquisition. </p>
<p>An implementation is required to clearly document the semantics and guarantees provided by each of the locking methods. It must also obey the interruption semantics as defined in this interface, to the extent that interruption of lock acquisition is supported: which is either totally, or only on method entry.</p>
<p>As interruption generally implies cancellation, and checks for interruption are often infrequent, an implementation can favor responding to an interrupt over normal method return. This is true even if it can be shown that the interrupt occurred after another action may have unblocked the thread. An implementation should document this behavior.</p>
</blockquote>
<pre><code class="java">public interface Lock {
    void lock();
    void lockInterruptibly() throws InterruptedException;
    boolean tryLock();
    boolean tryLock(long time, TimeUnit unit) throws InterruptedException;
    void unlock();
    Condition newCondition();
}
</code></pre>
<h5 id="ReentrantLock"><a href="#ReentrantLock" class="headerlink" title="ReentrantLock"></a>ReentrantLock</h5><p>Lockçš„æ ‡å‡†å®ç°, ä¸€ç§å¯é‡å…¥äº’æ–¥é”ï¼Œå…·æœ‰ä¸ä½¿ç”¨åŒæ­¥æ–¹æ³•å’Œè¯­å¥è®¿é—®çš„éšå¼ç›‘è§†å™¨é”ç›¸åŒçš„åŸºæœ¬è¡Œä¸ºå’Œè¯­ä¹‰ï¼Œä½†å…·æœ‰æ‰©å±•åŠŸèƒ½ã€‚(è·å–ç­‰å¾…é˜Ÿåˆ—,å½“å‰çº¿ç¨‹æ˜¯å¦è·å¾—é”ç­‰ç›‘æ§,è§ <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractOwnableSynchronizer.html" target="_blank" rel="noopener"><code>AbstractOwnableSynchronizer</code></a>)</p>
<p>ReentrantLockå½’æœ€åä¸€ä¸ªæˆåŠŸé”å®šçš„çº¿ç¨‹æ‰€æœ‰ï¼Œä½†è¿˜æ²¡æœ‰è§£é”å®ƒã€‚å½“é”ä¸å±äºå…¶ä»–çº¿ç¨‹æ—¶ï¼Œè°ƒç”¨é”çš„çº¿ç¨‹å°†è¿”å›å¹¶æˆåŠŸè·å–é”ã€‚å¦‚æœå½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰é”ï¼Œè¯¥æ–¹æ³•å°†ç«‹å³è¿”å›ã€‚å¯ä»¥ä½¿ç”¨isHeldByCurrentThread()å’ŒgetHoldCount()æ–¹æ³•æ£€æŸ¥è¿™ä¸€ç‚¹ã€‚</p>
<blockquote>
<p>A reentrant mutual exclusion Lock with the same basic behavior and semantics as the implicit monitor lock accessed using synchronized methods and statements, but with extended capabilities.</p>
<p>A ReentrantLock is owned by the thread last successfully locking, but not yet unlocking it. A thread invoking lock will return, successfully acquiring the lock, when the lock is not owned by another thread. The method will return immediately if the current thread already owns the lock. This can be checked using methods isHeldByCurrentThread(), and getHoldCount().</p>
</blockquote>
<pre><code class="java">public class ReentrantLock implements Lock, java.io.Serializable {
    private final Sync sync;
    abstract static class Sync extends AbstractQueuedSynchronizer {
        }
        static final class NonfairSync extends Sync{}
        static final class FairSync extends Sync{}
        public ReentrantLock() {
        sync = new NonfairSync();
    }
    public ReentrantLock(boolean fair) {
        sync = fair ? new FairSync() : new NonfairSync();
    }
    public int getHoldCount() {
        return sync.getHoldCount();
    }
    protected Thread getOwner() {
        return sync.getOwner();
    }
    public boolean hasWaiters(Condition condition) {
        if (condition == null)
            throw new NullPointerException();
        if (!(condition instanceof AbstractQueuedSynchronizer.ConditionObject))
            throw new IllegalArgumentException(&quot;not owner&quot;);
        return sync.hasWaiters((AbstractQueuedSynchronizer.ConditionObject)condition);
    }
    /**
     * è·å–é˜Ÿåˆ—çš„ç›‘æ§,çœç•¥äº†è·å–waittingçš„ 
     */ 
    protected Collection&lt;Thread&gt; getQueuedThreads() {
        return sync.getQueuedThreads();
    }
    public final int getQueueLength() {
        return sync.getQueueLength();
    }
    public final boolean hasQueuedThread(Thread thread) {
        return sync.isQueued(thread);
    }
    public final int getQueueLength() {
        return sync.getQueueLength();
    }
    protected Collection&lt;Thread&gt; getQueuedThreads() {
        return sync.getQueuedThreads();
    }
    ...
}
</code></pre>
<h5 id="ReadWriteLock"><a href="#ReadWriteLock" class="headerlink" title="ReadWriteLock"></a>ReadWriteLock</h5><p>è¯»å†™é”ç»´æŠ¤ä¸€å¯¹å…³è”çš„é”ï¼Œä¸€ä¸ªç”¨äºåªè¯»æ“ä½œï¼Œå¦ä¸€ä¸ªç”¨äºå†™æ“ä½œã€‚è¯»é”å¯ä»¥ç”±å¤šä¸ªè¯»çº¿ç¨‹åŒæ—¶æŒæœ‰ï¼Œåªè¦æ²¡æœ‰å†™çº¿ç¨‹ã€‚å†™é”æ˜¯ç‹¬å çš„ã€‚</p>
<p>A <code>ReadWriteLock</code> maintains a pair of associated <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/Lock.html" target="_blank" rel="noopener"><code>locks</code></a>, one for read-only operations and one for writing. The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReadWriteLock.html#readLock--" target="_blank" rel="noopener"><code>read lock</code></a> may be held simultaneously by multiple reader threads, so long as there are no writers. The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReadWriteLock.html#writeLock--" target="_blank" rel="noopener"><code>write lock</code></a> is exclusive.</p>
<pre><code class="java">public interface ReadWriteLock {
    /**
     * Returns the lock used for reading.
     *
     * @return the lock used for reading
     */
    Lock readLock();

    /**
     * Returns the lock used for writing.
     *
     * @return the lock used for writing
     */
    Lock writeLock();
}
</code></pre>
<h5 id="ReentrantReadWriteLock"><a href="#ReentrantReadWriteLock" class="headerlink" title="ReentrantReadWriteLock"></a>ReentrantReadWriteLock</h5><p>å¯é‡å…¥è¯»å†™é”, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReadWriteLock.html" target="_blank" rel="noopener"><code>ReadWriteLock</code></a> å®ç°,ç±»ä¼¼<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReentrantLock.html" target="_blank" rel="noopener"><code>ReentrantLock</code></a>.</p>
<p>This class has the following properties:</p>
<ul>
<li><strong>Acquisition order</strong>  è¯·æ±‚é¡ºåº(å…¬å¹³ã€éå…¬å¹³)</li>
<li><strong>Reentrancy</strong>  å¯é‡å…¥</li>
<li><strong>Lock downgrading</strong> é”é™çº§<ul>
<li>å¯é‡å…¥æ€§è¿˜å…è®¸ä»å†™é”é™çº§ä¸ºè¯»é”ï¼Œæ–¹æ³•æ˜¯è·å–å†™é”ï¼Œç„¶åæ˜¯è¯»é”ï¼Œç„¶åé‡Šæ”¾å†™é”ã€‚</li>
</ul>
</li>
<li><strong>Interruption of lock acquisition</strong> å¯ä¸­æ–­é”</li>
<li><strong>Condition support</strong> </li>
<li><strong>Instrumentation</strong>  ç›‘æ§</li>
</ul>
<pre><code class="java">/*
 * This lock supports a maximum of 65535 recursive write locks and 65535 read locks.
 */
public class ReentrantReadWriteLock implements ReadWriteLock, java.io.Serializable {
    /** Inner class providing readlock */
    private final ReentrantReadWriteLock.ReadLock readerLock;
    /** Inner class providing writelock */
    private final ReentrantReadWriteLock.WriteLock writerLock;
    /** Performs all synchronization mechanics */
    final Sync sync;
    /**
     * Creates a new {@code ReentrantReadWriteLock} with
     * default (nonfair) ordering properties.
     */
    public ReentrantReadWriteLock() {
        this(false);
    }

    /**
     * Creates a new {@code ReentrantReadWriteLock} with
     * the given fairness policy.
     *
     * @param fair {@code true} if this lock should use a fair ordering policy
     */
    public ReentrantReadWriteLock(boolean fair) {
        sync = fair ? new FairSync() : new NonfairSync();
        readerLock = new ReadLock(this);
        writerLock = new WriteLock(this);
    }
                /*
                 * ReadWriteLock impl
                 */
    public ReentrantReadWriteLock.WriteLock writeLock() { return writerLock; }
    public ReentrantReadWriteLock.ReadLock  readLock()  { return readerLock; }
    /**
     * Synchronization implementation for ReentrantReadWriteLock.
     * Subclassed into fair and nonfair versions.
     */
    abstract static class Sync extends AbstractQueuedSynchronizer {
        static final int SHARED_SHIFT   = 16;
        static final int SHARED_UNIT    = (1 &lt;&lt; SHARED_SHIFT);
        static final int MAX_COUNT      = (1 &lt;&lt; SHARED_SHIFT) - 1;
        static final int EXCLUSIVE_MASK = (1 &lt;&lt; SHARED_SHIFT) - 1;
       ...
    }
    static final long getThreadId(Thread thread) {
        return UNSAFE.getLongVolatile(thread, TID_OFFSET);
    }
    ...
    public static class ReadLock implements Lock, java.io.Serializable {
       ...
    }
    public static class WriteLock implements Lock, java.io.Serializable {
       ...
    }
}
</code></pre>
<h4 id="Conditions-ç›‘è§†å™¨"><a href="#Conditions-ç›‘è§†å™¨" class="headerlink" title="Conditions(ç›‘è§†å™¨)"></a>Conditions(ç›‘è§†å™¨)</h4><p>æ¡ä»¶å°†å¯¹è±¡ç›‘è§†æ–¹æ³•(waitã€notifyå’ŒnotifyAll) åˆ†è§£ä¸ºä¸åŒçš„å¯¹è±¡ï¼Œé€šè¿‡å°†å®ƒä»¬ä¸ä»»æ„é”å®ç°ç›¸ç»“åˆï¼Œä»è€Œå®ç°æ¯ä¸ªå¯¹è±¡å…·æœ‰å¤šä¸ªç­‰å¾…é›†çš„æ•ˆæœã€‚é”æ›¿æ¢åŒæ­¥æ–¹æ³•å’Œè¯­å¥çš„ä½¿ç”¨ï¼Œæ¡ä»¶æ›¿æ¢å¯¹è±¡ç›‘è§†å™¨æ–¹æ³•çš„ä½¿ç”¨ã€‚</p>
<p><code>Condition</code> factors out the <code>Object</code> monitor methods (<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#wait--" target="_blank" rel="noopener"><code>wait</code></a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notify--" target="_blank" rel="noopener"><code>notify</code></a> and <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html#notifyAll--" target="_blank" rel="noopener"><code>notifyAll</code></a>) into distinct objects to give the effect of having multiple wait-sets per object, by combining them with the use of arbitrary <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/Lock.html" target="_blank" rel="noopener"><code>Lock</code></a> implementations. </p>
<p>Where a <code>Lock</code> replaces the use of <code>synchronized</code> methods and statements, </p>
<p>a <code>Condition</code> replaces the use of the Object monitor methods.</p>
<pre><code class="java">public interface Condition {
    void await() throws InterruptedException;
    /*
     * Causes the current thread to wait until it is signalled.
     */
    void awaitUninterruptibly();
    long awaitNanos(long nanosTimeout) throws InterruptedException;
    boolean await(long time, TimeUnit unit) throws InterruptedException;
    boolean awaitUntil(Date deadline) throws InterruptedException;
    void signal();
    void signalAll();
}
</code></pre>
<p>ä¸»è¦å®ç° : java.util.concurrent.locks.AbstractQueuedSynchronizer.ConditionObject</p>
<h4 id="AbstractQueuedSynchronizers-é˜»å¡é˜Ÿåˆ—"><a href="#AbstractQueuedSynchronizers-é˜»å¡é˜Ÿåˆ—" class="headerlink" title="AbstractQueuedSynchronizers(é˜»å¡é˜Ÿåˆ—)"></a>AbstractQueuedSynchronizers(é˜»å¡é˜Ÿåˆ—)</h4><h5 id="AbstractQueuedSynchronizer"><a href="#AbstractQueuedSynchronizer" class="headerlink" title="AbstractQueuedSynchronizer"></a>AbstractQueuedSynchronizer</h5><p>AbstractQueuedSynchronizerç±»æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„è¶…ç±»ï¼Œç”¨äºå®šä¹‰ä¾èµ–äºæ’é˜Ÿé˜»å¡çº¿ç¨‹çš„é”å’Œå…¶ä»–åŒæ­¥å™¨ã€‚</p>
<h6 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h6><p>To use this class as the basis of a synchronizer, redefine the following methods, as applicable, by inspecting and/or modifying the synchronization state using <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.html#getState--" target="_blank" rel="noopener"><code>getState()</code></a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.html#setState-int-" target="_blank" rel="noopener"><code>setState(int)</code></a> and/or <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.html#compareAndSetState-int-int-" target="_blank" rel="noopener"><code>compareAndSetState(int, int)</code></a>:</p>
<ul>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.html#tryAcquire-int-" target="_blank" rel="noopener"><code>tryAcquire(int)</code></a></li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.html#tryRelease-int-" target="_blank" rel="noopener"><code>tryRelease(int)</code></a></li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.html#tryAcquireShared-int-" target="_blank" rel="noopener"><code>tryAcquireShared(int)</code></a></li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.html#tryReleaseShared-int-" target="_blank" rel="noopener"><code>tryReleaseShared(int)</code></a></li>
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractQueuedSynchronizer.html#isHeldExclusively--" target="_blank" rel="noopener"><code>isHeldExclusively()</code></a></li>
</ul>
<p>Each of these methods by default throws <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/UnsupportedOperationException.html" target="_blank" rel="noopener"><code>UnsupportedOperationException</code></a><em>only</em><code>final</code></p>
<p>You may also find the inherited methods from <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/AbstractOwnableSynchronizer.html" target="_blank" rel="noopener"><code>AbstractOwnableSynchronizer</code></a> useful to keep track of the thread owning an exclusive synchronizer. You are encouraged to use them â€“ this enables monitoring and diagnostic tools to assist users in determining which threads hold locks.</p>
<pre><code class="java">public abstract class AbstractQueuedSynchronizer extends AbstractOwnableSynchronizer
    implements java.io.Serializable {
    public class ConditionObject implements Condition, java.io.Serializable {
        /** First node of condition queue. */
        private transient Node firstWaiter;
        /** Last node of condition queue. */
        private transient Node lastWaiter;            
        /**
         * Adds a new waiter to wait queue.
         * @return its new wait node
         */
        private Node addConditionWaiter() {
            Node t = lastWaiter;
            // If lastWaiter is cancelled, clean out.
            if (t != null &amp;&amp; t.waitStatus != Node.CONDITION) {
                unlinkCancelledWaiters();
                t = lastWaiter;
            }
            Node node = new Node(Thread.currentThread(), Node.CONDITION);
            if (t == null)
                firstWaiter = node;
            else
                t.nextWaiter = node;
            lastWaiter = node;
            return node;
        }        
            }
    static final class Node {
        /** Marker to indicate a node is waiting in shared mode */
        static final Node SHARED = new Node();
        /** Marker to indicate a node is waiting in exclusive mode */
        static final Node EXCLUSIVE = null;

        /** waitStatus value to indicate thread has cancelled */
        static final int CANCELLED =  1;
        /** waitStatus value to indicate successor&#39;s thread needs unparking */
        static final int SIGNAL    = -1;
        /** waitStatus value to indicate thread is waiting on condition */
        static final int CONDITION = -2;
        /**
         * waitStatus value to indicate the next acquireShared should
         * unconditionally propagate
         */
        static final int PROPAGATE = -3;
        volatile int waitStatus;
        volatile Node prev;
        volatile Node next;
        volatile Thread thread;
        Node nextWaiter;
        final boolean isShared() {
            return nextWaiter == SHARED;
        }

    }
        public final void acquire(int arg) {
        if (!tryAcquire(arg) &amp;&amp; acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
            selfInterrupt();
    }        
    public final void acquireShared(int arg) {
        if (tryAcquireShared(arg) &lt; 0)
            doAcquireShared(arg);
    }
    public final boolean tryAcquireSharedNanos(int arg, long nanosTimeout)
            throws InterruptedException {
        if (Thread.interrupted())
            throw new InterruptedException();
        return tryAcquireShared(arg) &gt;= 0 ||
            doAcquireSharedNanos(arg, nanosTimeout);
    }    
    public final boolean release(int arg) {
        if (tryRelease(arg)) {
            Node h = head;
            if (h != null &amp;&amp; h.waitStatus != 0)
                unparkSuccessor(h);
            return true;
        }
        return false;
    }
    public final boolean releaseShared(int arg) {
        if (tryReleaseShared(arg)) {
            doReleaseShared();
            return true;
        }
        return false;
    }   
}
</code></pre>
<p>è¿™ä¸ªç±»æ¯”è¾ƒå…³é”®, å¤æ‚åº¦å¤ªé«˜äº†,æ¶‰åŠçš„ç»†èŠ‚å¤ªå¤š,å¦å•ç‹¬åˆ†æ</p>
<h5 id="AbstractQueuedLongSynchronizer"><a href="#AbstractQueuedLongSynchronizer" class="headerlink" title="AbstractQueuedLongSynchronizer"></a>AbstractQueuedLongSynchronizer</h5><p>AbstractQueuedLongSynchronizerç±»æä¾›äº†ç›¸åŒçš„åŠŸèƒ½ï¼Œä½†æ˜¯æ‰©å±•äº†å¯¹64ä½åŒæ­¥çŠ¶æ€çš„æ”¯æŒã€‚</p>
<h5 id="AbstractOwnableSynchronizer"><a href="#AbstractOwnableSynchronizer" class="headerlink" title="AbstractOwnableSynchronizer"></a>AbstractOwnableSynchronizer</h5><p>å®ƒä»¬éƒ½æ‰©å±•äº†AbstractOwnableSynchronizerç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç±»ï¼Œå¸®åŠ©è®°å½•å½“å‰æŒæœ‰ç‹¬å åŒæ­¥çš„çº¿ç¨‹ã€‚</p>
<pre><code class="java">public abstract class AbstractOwnableSynchronizer
    implements java.io.Serializable {

    /** Use serial ID even though all fields transient. */
    private static final long serialVersionUID = 3737899427754241961L;

    /**
     * Empty constructor for use by subclasses.
     */
    protected AbstractOwnableSynchronizer() { }

    /**
     * The current owner of exclusive mode synchronization.
     */
    private transient Thread exclusiveOwnerThread;

    /**
     * Sets the thread that currently owns exclusive access.
     * A {@code null} argument indicates that no thread owns access.
     * This method does not otherwise impose any synchronization or
     * {@code volatile} field accesses.
     * @param thread the owner thread
     */
    protected final void setExclusiveOwnerThread(Thread thread) {
        exclusiveOwnerThread = thread;
    }

    /**
     * Returns the thread last set by {@code setExclusiveOwnerThread},
     * or {@code null} if never set.  This method does not otherwise
     * impose any synchronization or {@code volatile} field accesses.
     * @return the owner thread
     */
    protected final Thread getExclusiveOwnerThread() {
        return exclusiveOwnerThread;
    }
}
</code></pre>
<h4 id="LockSupports"><a href="#LockSupports" class="headerlink" title="LockSupports"></a>LockSupports</h4><p>The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/LockSupport.html" target="_blank" rel="noopener"><code>LockSupport</code></a> class provides lower-level blocking and unblocking support that is useful for those developers implementing their own customized lock classes.</p>
<p>LockSupportç±»æä¾›äº†è¾ƒä½çº§åˆ«çš„é˜»å¡å’Œè§£é™¤é˜»å¡æ”¯æŒï¼Œè¿™å¯¹äºå®ç°è‡ªå®šä¹‰é”ç±»çš„å¼€å‘äººå‘˜éå¸¸æœ‰ç”¨ã€‚</p>
<h3 id="RecordğŸ“"><a href="#RecordğŸ“" class="headerlink" title="RecordğŸ“"></a>RecordğŸ“</h3><ul>
<li><p>TimeUnit ä¸ºå•¥ä¸éƒ½æŠ½è±¡æ–¹æ³•?è€Œæ˜¯æœ‰äº›éœ€è¦å®ç°,æœ‰äº›éœ€è¦æŠ½è±¡?</p>
</li>
<li><p>java.util.concurrent.Semaphore.Sync#nonfairTryAcquireShared å’Œjava.util.concurrent.Semaphore.Sync#reducePermits ä¸ºå•¥éœ€è¦é‡å¤å®ç°?</p>
</li>
<li><p>java.util.concurrent.locks.ReentrantReadWriteLock.ReadLock#newCondition ?</p>
<pre><code>  /**
   * Throws {@code UnsupportedOperationException} because
   * {@code ReadLocks} do not support conditions.
   *
   * @throws UnsupportedOperationException always
   */
</code></pre></li>
</ul>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 951488791@qq.com </span>
    </div>
</article>



<div class="article_copyright">
    <p><span class="copy-title">æ–‡ç« æ ‡é¢˜:</span>JDK_The Concurrent Framework</p>
    <p><span class="copy-title">æ–‡ç« å­—æ•°:</span><span class="post-count">8.8k</span></p>
    <p><span class="copy-title">æœ¬æ–‡ä½œè€…:</span><a href="javascript:void(0)" title="zhengyumin">zhengyumin</a></p>
    <p><span class="copy-title">å‘å¸ƒæ—¶é—´:</span>2019-08-10, 19:45:39</p>
    <p><span class="copy-title">æœ€åæ›´æ–°:</span>2019-08-24, 18:57:12</p>
    <span class="copy-title">åŸå§‹é“¾æ¥:</span><a class="post-url" href="/2019/08/10/JDK-The-Concurrent-Framework/" title="JDK_The Concurrent Framework">http://yoursite.com/2019/08/10/JDK-The-Concurrent-Framework/</a>
    <p>
        <span class="copy-title">ç‰ˆæƒå£°æ˜:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target="_blank">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚
    </p>
</div>





    




    </div>
    <div class="copyright">
        <p class="footer-entry">Â©2016-2019 zhengyumin</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">ç›®å½•</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" href="javascript:void(0)"></a>
    </div>
</div>
<div class="acParent"></div>

</body>
<script src="/js/jquery.pjax.js?v=1.0.1"></script>

<script src="/js/script.js?v=1.0.1"></script>
<script>
    var img_resize = 'default';
    /*ä½œè€…ã€æ ‡ç­¾çš„è‡ªåŠ¨è¡¥å…¨*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['#week','#hide','#jdk','#packages','#utils','#java','#note','#jvm','#distributed','#zookeeper','#framework','#kafka','#redis','#netty','#nio','#Spec','#thread','#spring','#tomcat','#mysql','#juc','#classLoader','#hotspot','#j2ee','#summary','#ioc','#lang','#elasticsearch','#servlet','#io','#serialization','#file','#gc','#ejb','#event','#collections','#map','#doc','#spring-mvc','#spring-webflux',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        
        $('pre code').each(function(){
            var lines = $(this).text().split('\n').length - 1, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0px;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
